<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Cvičenie k predmetu CPD"><link href=https://squidfunk.github.io/mkdocs-material/uloha2/ rel=canonical><meta name=author content="Martin Húdik"><link rel="shortcut icon" href=../assets/favicon.png><meta name=generator content="mkdocs-1.1, mkdocs-material-5.1.5"><title>Postup prác - Cvičenie k predmetu prednos dát</title><link rel=stylesheet href=../assets/stylesheets/main.df84b5fe.min.css><link rel=stylesheet href=../assets/stylesheets/palette.8435c73a.min.css><meta name=theme-color content=#3f51b5><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../stylesheets/extra.css><link rel="preconnect dns-prefetch" href=https://www.google-analytics.com><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-165560005-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#10-vytvorenie-rest-rozhrania-householdresource class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://squidfunk.github.io/mkdocs-material/ title="Cvičenie k predmetu prednos dát" class="md-header-nav__button md-logo" aria-label="Cvičenie k predmetu prednos dát"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"><path d="M3.136 17.387v42.932l42.932 21.467L3.136 17.387z"/><path fill-opacity=.5 d="M21.91 8l42.933 64.398-18.775 9.388L3.136 17.387 21.91 8z"/><path d="M67.535 17.387L40.273 35.543l21.878 32.818 5.384 2.691V17.387z"/><path fill-opacity=.25 d="M67.535 17.387v53.666l18.774-9.388V8l-18.774 9.387z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Cvičenie k predmetu prednos dát </span> <span class="md-header-nav__topic md-ellipsis"> Postup prác </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/hudikm/IoTNode_CPD2020.git title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> CPD2020 </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class="md-tabs md-tabs--active" aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Úloha </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://squidfunk.github.io/mkdocs-material/ title="Cvičenie k predmetu prednos dát" class="md-nav__button md-logo" aria-label="Cvičenie k predmetu prednos dát"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"><path d="M3.136 17.387v42.932l42.932 21.467L3.136 17.387z"/><path fill-opacity=.5 d="M21.91 8l42.933 64.398-18.775 9.388L3.136 17.387 21.91 8z"/><path d="M67.535 17.387L40.273 35.543l21.878 32.818 5.384 2.691V17.387z"/><path fill-opacity=.25 d="M67.535 17.387v53.666l18.774-9.388V8l-18.774 9.387z"/></svg> </a> Cvičenie k predmetu prednos dát </label> <div class=md-nav__source> <a href=https://github.com/hudikm/IoTNode_CPD2020.git title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> CPD2020 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1 checked> <label class=md-nav__link for=nav-1> Úloha <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Úloha data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Úloha </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-1 type=checkbox id=nav-1-1> <label class=md-nav__link for=nav-1-1> Zadanie I <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Zadanie I" data-md-level=2> <label class=md-nav__title for=nav-1-1> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Zadanie I </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title=Úvod class=md-nav__link> Úvod </a> </li> <li class=md-nav__item> <a href=../postup/ title="Postup prác" class=md-nav__link> Postup prác </a> </li> <li class=md-nav__item> <a href=../postup/#uloha-na-dopracovanie title=Úloha class=md-nav__link> Úloha </a> </li> <li class=md-nav__item> <a href=../bonus/ title="Dobrovolná úloha" class=md-nav__link> Dobrovolná úloha </a> </li> <li class=md-nav__item> <a href=../RESTapi/ title="Dokumentácia k REST API" class=md-nav__link> Dokumentácia k REST API </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-2 type=checkbox id=nav-1-2 checked> <label class=md-nav__link for=nav-1-2> Zadanie II <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Zadanie II" data-md-level=2> <label class=md-nav__title for=nav-1-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Zadanie II </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../uvod_2/ title=Úvod class=md-nav__link> Úvod </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Postup prác <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title="Postup prác" class="md-nav__link md-nav__link--active"> Postup prác </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#10-vytvorenie-rest-rozhrania-householdresource class=md-nav__link> 1.0 Vytvorenie REST rozhrania HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#10-vytvorenie-rest-rozhrania-householdresource_1 class=md-nav__link> 1.0 Vytvorenie REST rozhrania HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#11-zaregistrovanie-prvej-casti-rest-rozhrania class=md-nav__link> 1.1 Zaregistrovanie prvej časti REST rozhrania </a> </li> <li class=md-nav__item> <a href=#12-pridanie-swagger-dokumentacnych-anotacii class=md-nav__link> 1.2 Pridanie swagger dokumentačných anotácií </a> </li> <li class=md-nav__item> <a href=#13-doplnenie-post-metody-v-householdresource class=md-nav__link> 1.3 Doplnenie POST metódy v HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#14-json-serializacia class=md-nav__link> 1.4 JSON serializácia </a> </li> <li class=md-nav__item> <a href=#15-json-validacia-dat class=md-nav__link> 1.5 JSON validácia dát </a> </li> <li class=md-nav__item> <a href=#20-konfiguracia-databazy class=md-nav__link> 2.0 Konfigúrácia databázy </a> </li> <li class=md-nav__item> <a href=#21-pripojenie-hibernate-orm-kniznice class=md-nav__link> 2.1 Pripojenie Hibernate ORM knižnice </a> </li> <li class=md-nav__item> <a href=#30-vytvorenie-datoveho-modelu-trieda-household class=md-nav__link> 3.0 Vytvorenie dátového modelu trieda: HouseHold </a> </li> <li class=md-nav__item> <a href=#31-vytvorenie-pristupoveho-objektu-do-databazy-householddao class=md-nav__link> 3.1 Vytvorenie prístupového objektu do databázy: HouseHoldDAO </a> </li> <li class=md-nav__item> <a href=#32-otestovanie-zapisu-do-databazy-householddao class=md-nav__link> 3.2 Otestovanie zápisu do databázy: HouseHoldDAO </a> </li> <li class=md-nav__item> <a href=#33-pristup-do-databazy-cez-dao-v-householdresource class=md-nav__link> 3.3 Prístup do dátabázy cez DAO v HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#40-filtrovanievyhladavanie-v-databaze-pomocou-namedquery class=md-nav__link> 4.0 Filtrovanie/vyhľadávanie v databáze pomocou NamedQuery </a> </li> <li class=md-nav__item> <a href=#41-pouzitie-namedquery-v-dao-objekte class=md-nav__link> 4.1 Použitie NamedQuery v DAO objekte </a> </li> <li class=md-nav__item> <a href=#42-aplikovanie-dao-filtrov-v-householdresource class=md-nav__link> 4.2 Aplikovanie DAO filtrov v HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#50-dedicnost-s-orm-pristupom class=md-nav__link> 5.0 Dedičnosť s ORM prístupom </a> </li> <li class=md-nav__item> <a href=#51-uprava-datadao-objektu class=md-nav__link> 5.1 Úprava DataDAO objektu </a> </li> <li class=md-nav__item> <a href=#52-otestovanie-novych-datovy-objektov class=md-nav__link> 5.2 Otestovanie nových dátový objektov </a> </li> <li class=md-nav__item> <a href=#53-dedicnost-pri-pouziti-json-serializaciedeserializacie class=md-nav__link> 5.3 Dedičnosť pri použití JSON serializácie/deserializácie </a> </li> <li class=md-nav__item> <a href=#54-json-deserializacia-casovych-udajov class=md-nav__link> 5.4 JSON deserializácia časových údajov </a> </li> <li class=md-nav__item> <a href=#60-vytvorenie-vztahu-many-to-many class=md-nav__link> 6.0 Vytvorenie vzťahu Many-to-Many </a> </li> <li class=md-nav__item> <a href=#61-uprava-fielddao-triedy class=md-nav__link> 6.1 Úprava FieldDAO triedy </a> </li> <li class=md-nav__item> <a href=#62-otestovanie-vytvoreneho-vztahu-many-to-many class=md-nav__link> 6.2 Otestovanie vytvoreného vzťahu Many-To-many </a> </li> <li class=md-nav__item> <a href=#70-pretazenie-metod-hashcode-a-equals class=md-nav__link> 7.0 Pretaženie metód hashCode a equals </a> </li> <li class=md-nav__item> <a href=#80-pridanie-moznosti-vymazat-polozku-field class=md-nav__link> 8.0 Pridanie možnosti vymazať položku Field </a> </li> <li class=md-nav__item> <a href=#81-otestovanie-zmazania-field class=md-nav__link> 8.1 Otestovanie zmazania Field </a> </li> <li class=md-nav__item> <a href=#82-vytvorenie-kaskadovej-akcie-pre-mazanie-prvku-field class=md-nav__link> 8.2 Vytvorenie káskádovej akcie pre mazanie prvku Field </a> </li> <li class=md-nav__item> <a href=#90-doplnenie-chybajucich-namedquery class=md-nav__link> 9.0 Doplnenie chýbajúcich NamedQuery </a> </li> <li class=md-nav__item> <a href=#91-doplnenie-chybajucich-dao-metod class=md-nav__link> 9.1 Doplnenie chýbajúcich DAO metód </a> </li> <li class=md-nav__item> <a href=#92-zaregistrovanie-zvysnych-rest-zdrojov class=md-nav__link> 9.2 Zaregistrovanie zvyšných REST zdrojov </a> </li> <li class=md-nav__item> <a href=#93-implemntovanie-fieldresource-zdroja class=md-nav__link> 9.3 Implemntovanie FieldResource zdroja </a> </li> <li class=md-nav__item> <a href=#94-doplnenie-chybajucich-zdrojov-v-triede-householdresource class=md-nav__link> 9.4 Doplnenie chýbajúcich zdrojov v triede HouseHoldResource </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../zadanie2/ title=Úloha class=md-nav__link> Úloha </a> </li> <li class=md-nav__item> <a href=../zadanie2/#dobrovolna-uloha title="Dobrovolná úloha" class=md-nav__link> Dobrovolná úloha </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3 type=checkbox id=nav-1-3> <label class=md-nav__link for=nav-1-3> Teória <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=Teória data-md-level=2> <label class=md-nav__title for=nav-1-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Teória </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../web_services/ title="Webové služby" class=md-nav__link> Webové služby </a> </li> <li class=md-nav__item> <a href=../maven/ title=Maven class=md-nav__link> Maven </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-3 type=checkbox id=nav-1-3-3> <label class=md-nav__link for=nav-1-3-3> GIT <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label=GIT data-md-level=3> <label class=md-nav__title for=nav-1-3-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> GIT </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../git/ title=Popis class=md-nav__link> Popis </a> </li> <li class=md-nav__item> <a href=../intelij_git/ title="Použitie v InteliJ" class=md-nav__link> Použitie v InteliJ </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#10-vytvorenie-rest-rozhrania-householdresource class=md-nav__link> 1.0 Vytvorenie REST rozhrania HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#10-vytvorenie-rest-rozhrania-householdresource_1 class=md-nav__link> 1.0 Vytvorenie REST rozhrania HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#11-zaregistrovanie-prvej-casti-rest-rozhrania class=md-nav__link> 1.1 Zaregistrovanie prvej časti REST rozhrania </a> </li> <li class=md-nav__item> <a href=#12-pridanie-swagger-dokumentacnych-anotacii class=md-nav__link> 1.2 Pridanie swagger dokumentačných anotácií </a> </li> <li class=md-nav__item> <a href=#13-doplnenie-post-metody-v-householdresource class=md-nav__link> 1.3 Doplnenie POST metódy v HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#14-json-serializacia class=md-nav__link> 1.4 JSON serializácia </a> </li> <li class=md-nav__item> <a href=#15-json-validacia-dat class=md-nav__link> 1.5 JSON validácia dát </a> </li> <li class=md-nav__item> <a href=#20-konfiguracia-databazy class=md-nav__link> 2.0 Konfigúrácia databázy </a> </li> <li class=md-nav__item> <a href=#21-pripojenie-hibernate-orm-kniznice class=md-nav__link> 2.1 Pripojenie Hibernate ORM knižnice </a> </li> <li class=md-nav__item> <a href=#30-vytvorenie-datoveho-modelu-trieda-household class=md-nav__link> 3.0 Vytvorenie dátového modelu trieda: HouseHold </a> </li> <li class=md-nav__item> <a href=#31-vytvorenie-pristupoveho-objektu-do-databazy-householddao class=md-nav__link> 3.1 Vytvorenie prístupového objektu do databázy: HouseHoldDAO </a> </li> <li class=md-nav__item> <a href=#32-otestovanie-zapisu-do-databazy-householddao class=md-nav__link> 3.2 Otestovanie zápisu do databázy: HouseHoldDAO </a> </li> <li class=md-nav__item> <a href=#33-pristup-do-databazy-cez-dao-v-householdresource class=md-nav__link> 3.3 Prístup do dátabázy cez DAO v HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#40-filtrovanievyhladavanie-v-databaze-pomocou-namedquery class=md-nav__link> 4.0 Filtrovanie/vyhľadávanie v databáze pomocou NamedQuery </a> </li> <li class=md-nav__item> <a href=#41-pouzitie-namedquery-v-dao-objekte class=md-nav__link> 4.1 Použitie NamedQuery v DAO objekte </a> </li> <li class=md-nav__item> <a href=#42-aplikovanie-dao-filtrov-v-householdresource class=md-nav__link> 4.2 Aplikovanie DAO filtrov v HouseHoldResource </a> </li> <li class=md-nav__item> <a href=#50-dedicnost-s-orm-pristupom class=md-nav__link> 5.0 Dedičnosť s ORM prístupom </a> </li> <li class=md-nav__item> <a href=#51-uprava-datadao-objektu class=md-nav__link> 5.1 Úprava DataDAO objektu </a> </li> <li class=md-nav__item> <a href=#52-otestovanie-novych-datovy-objektov class=md-nav__link> 5.2 Otestovanie nových dátový objektov </a> </li> <li class=md-nav__item> <a href=#53-dedicnost-pri-pouziti-json-serializaciedeserializacie class=md-nav__link> 5.3 Dedičnosť pri použití JSON serializácie/deserializácie </a> </li> <li class=md-nav__item> <a href=#54-json-deserializacia-casovych-udajov class=md-nav__link> 5.4 JSON deserializácia časových údajov </a> </li> <li class=md-nav__item> <a href=#60-vytvorenie-vztahu-many-to-many class=md-nav__link> 6.0 Vytvorenie vzťahu Many-to-Many </a> </li> <li class=md-nav__item> <a href=#61-uprava-fielddao-triedy class=md-nav__link> 6.1 Úprava FieldDAO triedy </a> </li> <li class=md-nav__item> <a href=#62-otestovanie-vytvoreneho-vztahu-many-to-many class=md-nav__link> 6.2 Otestovanie vytvoreného vzťahu Many-To-many </a> </li> <li class=md-nav__item> <a href=#70-pretazenie-metod-hashcode-a-equals class=md-nav__link> 7.0 Pretaženie metód hashCode a equals </a> </li> <li class=md-nav__item> <a href=#80-pridanie-moznosti-vymazat-polozku-field class=md-nav__link> 8.0 Pridanie možnosti vymazať položku Field </a> </li> <li class=md-nav__item> <a href=#81-otestovanie-zmazania-field class=md-nav__link> 8.1 Otestovanie zmazania Field </a> </li> <li class=md-nav__item> <a href=#82-vytvorenie-kaskadovej-akcie-pre-mazanie-prvku-field class=md-nav__link> 8.2 Vytvorenie káskádovej akcie pre mazanie prvku Field </a> </li> <li class=md-nav__item> <a href=#90-doplnenie-chybajucich-namedquery class=md-nav__link> 9.0 Doplnenie chýbajúcich NamedQuery </a> </li> <li class=md-nav__item> <a href=#91-doplnenie-chybajucich-dao-metod class=md-nav__link> 9.1 Doplnenie chýbajúcich DAO metód </a> </li> <li class=md-nav__item> <a href=#92-zaregistrovanie-zvysnych-rest-zdrojov class=md-nav__link> 9.2 Zaregistrovanie zvyšných REST zdrojov </a> </li> <li class=md-nav__item> <a href=#93-implemntovanie-fieldresource-zdroja class=md-nav__link> 9.3 Implemntovanie FieldResource zdroja </a> </li> <li class=md-nav__item> <a href=#94-doplnenie-chybajucich-zdrojov-v-triede-householdresource class=md-nav__link> 9.4 Doplnenie chýbajúcich zdrojov v triede HouseHoldResource </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Postup prác</h1> <p>Na adrese <a href=https://github.com/hudikm/HouseHoldService_CPD2020><code>https://github.com/hudikm/HouseHoldService_CPD2020</code></a> sa nachádza šablóna projektu. Rovnakým postupom ako v zadaní 1 vytvorte vo svojom GitHub učte kópiou projektu a naklonujte si projekt na lokálny počítač. </p> <div class="admonition warning"> <p class=admonition-title>Názov projektu treba zmeniť na '<em>HouseHoldService</em>'</p> <p><img alt src=../images/Screenshot_20200526_111427.png#center> Ak sa nechá pôvodný názov <code>HouseHoldService_CPD2020</code> bude treba v konfigurácii projektu zmeniť názov. </p> </div> <div class="admonition note"> <p class=admonition-title>Spustenie MariaDB</p> <p>Databáza je spustená pomocou docker obrazu. Príkaz na spustenie: <code>docker-compose up</code> musíte sa nachádzať v projektovom adresári kde sa nachádza súbor <code>docker-compose.yml</code>. </p> </div> <!--tgen file='/home/martin/IdeaProjects/WeatherStation/HouseHoldServiceCopy/out.patch' lang=java tabs t_new="Nové" t_old="Pred úpravou" headerRegex="^(?:\t| )*(?:(?:public)|(?:private)|(?:static)|(?:protected))" --> <!--____tgen step=all template='gen_tags_separate_header'  --> <!--tgen step=1.0 template='files_list' noupdate  --> <h4 id=10-vytvorenie-rest-rozhrania-householdresource>1.0 Vytvorenie REST rozhrania HouseHoldResource <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/42ca9531dc851212ea51475cc5b42382ebbbce83/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#10-vytvorenie-rest-rozhrania-householdresource title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code> .
 └─ src
    └─ main
       ├─ resources
       │  ├─ banner.txt
       │  └─ hibernate.cfg.xml <span class=c1>#Konf. hibernate knižnice(len na gen. vizuálnych diagramov)</span>
       └─ java
          └─ sk
             └─ fri
                └─ uniza
                   ├─ resources <span class=c1># Implementácia REST rozhrania</span>
                   │  ├─ FieldResource.java
                   │  ├─ HouseHoldResource.java
                   │  └─ IoTNodeResource.java
                   ├─ model <span class=c1># Dátový model</span>
                   │  ├─ AbstractData.java
                   │  ├─ ContactPerson.java
                   │  ├─ DataDouble.java
                   │  ├─ DataInteger.java
                   │  ├─ DataString.java
                   │  ├─ Field.java
                   │  ├─ HouseHold.java
                   │  └─ IotNode.java
                   ├─ health <span class=c1># Pomocné triedy na rôzne testy</span>
                   │  └─ DatabaseHealthCheck.java
                   ├─ db <span class=c1># Databázové objekty určené na prístup k databáze</span>
                   │  ├─ DataDAO.java
                   │  ├─ FieldDAO.java
                   │  ├─ HouseHoldDAO.java
                   │  └─ IotNodeDAO.java
                   ├─ core <span class=c1># Pomocné triedy</span>
                   │  ├─ DateFormat.java
                   │  ├─ DateParameterConverter.java
                   │  ├─ DateParameterConverterProvider.java
                   │  └─ DateTimeFormat.java
                   ├─ api <span class=c1># Pomocné triedy</span>
                   │  └─ FilterEnum.java
                   ├─ HouseHoldServiceApplication.java <span class=c1># Vstupná trieda aplikácie</span>
                   └─ HouseHoldServiceConfiguration.java <span class=c1># Konfiguračná trieda</span>
</code></pre></div> <!--end--> <!--tgen step=1.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=10-vytvorenie-rest-rozhrania-householdresource_1>1.0 Vytvorenie REST rozhrania HouseHoldResource <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/42ca9531dc851212ea51475cc5b42382ebbbce83/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#10-vytvorenie-rest-rozhrania-householdresource_1 title="Permanent link">&para;</a></h4> <!--end--> <p>Podľa zadania máme vytvoriť webovú službu s využitím REST rozhrania na komunikáciu. REST rozhranie má obsahovať rôzne URI adresy, ktoré poskytnú prístup k jednotlivým zdrojom s využitím HTTP metód. Na začiatok si implementujeme jednoduchý koncový bod <code>GET /household/{id}</code>, ktorý poskytne údaje o konkrétnej domácnosti <code>HouseHold</code>. Tento koncový bod bude súčasťou kolekcie viacerých koncových bodov, ktoré budú dostupné na URI adrese <code>/household</code> . Každá REST trieda zdrojov musí obsahovať definíciu URI adresy, v tomto prípade sa na tento účel používa anotácia <code>@Path()</code>. Anotácie <code>@Produces, @Consumes</code>slúžia na definovanie formátu prenášaných dát. Táto informácia bude súčasťou každej HTTP hlavičky.</p> <!--tgen step=1.0 template='mkdocs_body_only' noupdate --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/42ca9531dc851212ea51475cc5b42382ebbbce83/src/main/java/sk/fri/uniza/resources/HouseHoldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/HouseHoldResource.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=1:2> <input name=__tabbed_1 type=radio id=__tabbed_1_1 checked=checked><label for=__tabbed_1_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=p>)</span>

<span class=hll><span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;/household&quot;</span><span class=p>)</span> <span class=c1>// Koreňová adresa kolekcie koncových bodov</span>
</span><span class=hll>                    <span class=c1>// pre prístup k zdrojom domácností // Súčasť JAX-RS</span>
</span><span class=hll><span class=nd>@Produces</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span><span class=c1>// Výstupné dáta sú vo forme JSON //JAX-RS</span>
</span><span class=hll><span class=nd>@Consumes</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span> <span class=c1>//Vstupné dáta sú vo forme JSON //JAX-RS</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHoldResource</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=n>HouseHoldDAO</span> <span class=n>houseHoldDAO</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_1 type=radio id=__tabbed_1_2><label for=__tabbed_1_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=p>)</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHoldResource</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=n>HouseHoldDAO</span> <span class=n>houseHoldDAO</span><span class=p>;</span>
</code></pre></div></div> </div> <p>Samotný koncový bod je definovaný ako kombinácia HTTP metódy a URI adresy, v tomto prípade <code>@GET</code> a <code>@Path("{id}")</code>. Pri definícii URI adresy môžeme definovať premenné, ktoré si vyžiadame ako vstupné parametre v metóde pomocou anotácie <code>@PathParam</code>. Dátový typ takejto premennej je spravidla jednoduchý (napr. <code>Long, Integer, String</code>) . Návratová hodnota metódy koncového bodu definuje výstupný zdroj, v tomto prípade sa jedná o údaje o domácnosti reprezentované triedou <code>HouseHold</code>. Tento objekt je automaticky serializovaný do požadovanej podoby.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Dropwizárd používa interne Jackson knižnicu na serializáciu/deserializáciu objektov na a z JSON formátu.</p> </div> <blockquote> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=2:2> <input name=__tabbed_2 type=radio id=__tabbed_2_1 checked=checked><label for=__tabbed_2_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>

<span class=hll>    <span class=nd>@GET</span> <span class=c1>//HTTP metóda</span>
</span><span class=hll>    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{id}&quot;</span><span class=p>)</span> <span class=c1>// Jedna vetva hlavnej adresy /household</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span>
    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>getHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>Long</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=k>new</span> <span class=n>HouseHold</span><span class=p>();</span>
</span>    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_2 type=radio id=__tabbed_2_2><label for=__tabbed_2_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>


    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>getHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=n>Long</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=1.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=11-zaregistrovanie-prvej-casti-rest-rozhrania>1.1 Zaregistrovanie prvej časti REST rozhrania <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/7a105a33d1a13887d5848c64ab32192a9f608de7/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#11-zaregistrovanie-prvej-casti-rest-rozhrania title="Permanent link">&para;</a></h4> <!--end--> <p>V Dropwizard-e je nutné každú triedu, ktorá je súčasťou REST rozhrania a poskytuje prístup k zdrojom zaregistrovať do RESTovej knižnice <a href=https://eclipse-ee4j.github.io/jersey.github.io/documentation/latest/index.html><code>Jersey</code></a>. Táto knižnica implementuje štandard JAX-RS (JSR-370).</p> <!--tgen step=1.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/7a105a33d1a13887d5848c64ab32192a9f608de7/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=3:2> <input name=__tabbed_3 type=radio id=__tabbed_3_1 checked=checked><label for=__tabbed_3_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=p>(</span><span class=kd>final</span> <span class=n>HouseHoldServiceConfiguration</span> <span class=n>configuration</span><span class=p>,</span>
                    <span class=kd>final</span> <span class=n>Environment</span> <span class=n>environment</span><span class=p>)</span> <span class=p>{</span>

<span class=hll>        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
</span><span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
</span><span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>HouseHoldResource</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=kc>null</span><span class=p>));</span>
</span>    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_3 type=radio id=__tabbed_3_2><label for=__tabbed_3_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=p>(</span><span class=kd>final</span> <span class=n>HouseHoldServiceConfiguration</span> <span class=n>configuration</span><span class=p>,</span>
                    <span class=kd>final</span> <span class=n>Environment</span> <span class=n>environment</span><span class=p>)</span> <span class=p>{</span>

    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=1.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=12-pridanie-swagger-dokumentacnych-anotacii>1.2 Pridanie swagger dokumentačných anotácií <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/380a4574e9bb003f6fb8e203068fee70a5182349/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#12-pridanie-swagger-dokumentacnych-anotacii title="Permanent link">&para;</a></h4> <!--end--> <p>Swagger je dokumentačný nástroj, ktorý na základe vložených anotácii a Java reflexie vygeneruje dokumentáciu. Túto dokumentáciu je možne zobraziť v interaktívnom prehliadači, ktorý bude dostupný po spustení na adrese: <a href=http://localhost:8080/swagger>http://localhost:8080/swagger</a>. Táto dokumentácia sa dá použiť aj na vygenerovať kódu pre stranu klienta pristupujúce na webovej služby.</p> <p>V tejto verzii Dropwizardu sa používa verzia SwaggerUI v3.23.0 a Swagger API vo verzií <a href=https://github.com/swagger-api/swagger-core/wiki/Annotations-1.5.X>1.5.22</a></p> <!--tgen step=1.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/380a4574e9bb003f6fb8e203068fee70a5182349/src/main/java/sk/fri/uniza/resources/HouseHoldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/HouseHoldResource.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=4:2> <input name=__tabbed_4 type=radio id=__tabbed_4_1 checked=checked><label for=__tabbed_4_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>schemes</span> <span class=o>=</span> <span class=p>{</span><span class=n>SwaggerDefinition</span><span class=p>.</span><span class=na>Scheme</span><span class=p>.</span><span class=na>HTTP</span><span class=p>}</span>

<span class=p>)</span>
<span class=hll><span class=nd>@Api</span><span class=p>(</span><span class=s>&quot;/household&quot;</span><span class=p>)</span> <span class=c1>// Swagger</span>
</span><span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;/household&quot;</span><span class=p>)</span> <span class=c1>// JAX-RS</span>
<span class=nd>@Produces</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span><span class=c1>//Výstupné dáta sú vo forme JSON //JAX-RS</span>
<span class=nd>@Consumes</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span> <span class=c1>//Vstupné dáta sú vo forme JSON //JAX-RS</span>
</code></pre></div></div> <input name=__tabbed_4 type=radio id=__tabbed_4_2><label for=__tabbed_4_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>schemes</span> <span class=o>=</span> <span class=p>{</span><span class=n>SwaggerDefinition</span><span class=p>.</span><span class=na>Scheme</span><span class=p>.</span><span class=na>HTTP</span><span class=p>}</span>

<span class=p>)</span>
<span class=hll>
</span><span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;/household&quot;</span><span class=p>)</span> <span class=c1>// JAX-RS</span>
<span class=nd>@Produces</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span><span class=c1>//Výstupné dáta sú vo forme JSON //JAX-RS</span>
<span class=nd>@Consumes</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span> <span class=c1>//Vstupné dáta sú vo forme JSON //JAX-RS</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=5:2> <input name=__tabbed_5 type=radio id=__tabbed_5_1 checked=checked><label for=__tabbed_5_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@GET</span>
    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{id}&quot;</span><span class=p>)</span>
    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
<span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Údaje o konkrétnej domácnosť&quot;</span><span class=p>)</span>
</span>    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>getHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=nd>@ApiParam</span><span class=p>(</span><span class=n>required</span> <span class=o>=</span> <span class=kc>true</span><span class=p>)</span>
</span>            <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>Long</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>HouseHold</span><span class=p>();</span>
    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_5 type=radio id=__tabbed_5_2><label for=__tabbed_5_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@GET</span>
    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{id}&quot;</span><span class=p>)</span>
    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
<span class=hll>
</span>    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>getHouseHold</span><span class=p>(</span>
            <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>Long</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>HouseHold</span><span class=p>();</span>
    <span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <p>Po tomto bode si môžeme aplikáciu spustiť a vyskúšať dvoma spôsobmi:</p> <ol> <li>V internetovom prehliadači zadáme adresu <code>http://localhost:8080/household/1</code> a dostaneme nasledovnú JSON odpoveď: <code>{"id":null,"city":null,"zip":null,"contactPerson":null,"data":null,"iotNode":null,"state":null,"street":null}</code></li> <li>Použijeme swagger interaktívnu dokumentáciu na adrese: <a href=http://localhost:8080/swagger>http://localhost:8080/swagger</a>.</li> </ol> <!--tgen step=1.3 template='mkdocs_header_only'  --> <p><br></p> <h4 id=13-doplnenie-post-metody-v-householdresource>1.3 Doplnenie POST metódy v HouseHoldResource <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/50e567b012f960aebf408690446de526d77de591/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#13-doplnenie-post-metody-v-householdresource title="Permanent link">&para;</a></h4> <!--end--> <p>Obdobný spôsobom ako sme si vytvorili HTTP metódu <code>@GET</code> si vytvoríme nový koncový bod s využitím HTTP metódy <code>@POST</code> , ktorý bude slúžiť na pridanie nového objektu <code>HouseHold</code>. Keďže nedefinujeme žiadnu adresu tak tento koncový bod bude priamo na koreňovej adrese <code>/household</code>. Každá URI adresa môže obsahovať z každej HTTP metódy iba jeden exemplár, to znamená, že ak by sme potrebovali doplniť ďalšiu metódu <code>@POST</code> musíme ju umiestniť už na novú pod-adresu. </p> <p>Vstupný parameter metódy definuje ako majú vyzerať vstupné dáta. Inak povedané vstupné dáta musia byť vo formáte JSON a musia reprezentovať serializovanú triedu <code>HouseHold</code> </p> <blockquote> <p>Trieda <code>HouseHold</code> v JSON formate</p> <div class=highlight><pre><span></span><code><span class=p>{</span>
  <span class=nt>&quot;id&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
  <span class=nt>&quot;street&quot;</span><span class=p>:</span> <span class=s2>&quot;Univerzitná&quot;</span><span class=p>,</span>
  <span class=nt>&quot;city&quot;</span><span class=p>:</span> <span class=s2>&quot;Žilina&quot;</span><span class=p>,</span>
  <span class=nt>&quot;state&quot;</span><span class=p>:</span> <span class=s2>&quot;Slovakia&quot;</span><span class=p>,</span>
  <span class=nt>&quot;zip&quot;</span><span class=p>:</span> <span class=s2>&quot;01008&quot;</span><span class=p>,</span>
  <span class=nt>&quot;contactPerson&quot;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&quot;firstName&quot;</span><span class=p>:</span> <span class=s2>&quot;Janko&quot;</span><span class=p>,</span>
    <span class=nt>&quot;lastName&quot;</span><span class=p>:</span> <span class=s2>&quot;Hraško&quot;</span><span class=p>,</span>
    <span class=nt>&quot;phone&quot;</span><span class=p>:</span> <span class=s2>&quot;0907 123 456&quot;</span><span class=p>,</span>
    <span class=nt>&quot;email&quot;</span><span class=p>:</span> <span class=s2>&quot;em@mail.sk&quot;</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </blockquote> <!--tgen step=1.3 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/50e567b012f960aebf408690446de526d77de591/src/main/java/sk/fri/uniza/resources/HouseHoldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/HouseHoldResource.java</strong></p> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=6:2> <input name=__tabbed_6 type=radio id=__tabbed_6_1 checked=checked><label for=__tabbed_6_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>

<span class=hll>    <span class=nd>@POST</span> <span class=cm>/*JAX-RS*/</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session // Dropwizard</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Pridanie novej domácnosti&quot;</span><span class=p>)</span>
</span>    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>createHouseHold</span><span class=p>(</span><span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>houshold</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>updateHouseHold</span><span class=p>(</span>
</code></pre></div></div> <input name=__tabbed_6 type=radio id=__tabbed_6_2><label for=__tabbed_6_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>

<span class=hll>
</span>    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>createHouseHold</span><span class=p>(</span><span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>updateHouseHold</span><span class=p>(</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=1.4 template='mkdocs_header_only'  --> <p><br></p> <h4 id=14-json-serializacia>1.4 JSON serializácia <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/78ccafff54f49ff28dcec35dcb74392c88a21100/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#14-json-serializacia title="Permanent link">&para;</a></h4> <!--end--> <p>Ako už bolo spomenuté Dropwizard používa na prácu s JSON formátom knižnicu Jackson. Pre serializáciu a deserializáciu sa využívajú rôzne anotácie. Tu je krátky prehľad základných <a href=http://tutorials.jenkov.com/java-json/jackson-annotations.html>anotácií</a>. </p> <p>V tomto kroku prinútime Jackson knižnicu ignorovať niektoré atribúty triedy <code>HouseHold</code>. Pre serializáciu/deserializáciu nemajú význam a tak ich zakážeme používať zapísaním anotácie '<a class="magiclink magiclink-github magiclink-mention" href=https://github.com/JsonIgnore title="GitHub User: JsonIgnore">@JsonIgnore</a>'.</p> <!--tgen step=1.4 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/78ccafff54f49ff28dcec35dcb74392c88a21100/src/main/java/sk/fri/uniza/model/HouseHold.java>🖹</a> src/main/java/sk/fri/uniza/model/HouseHold.java</strong></p> <p>public class HouseHold {</p> </blockquote> <div class=tabbed-set data-tabs=7:2> <input name=__tabbed_7 type=radio id=__tabbed_7_1 checked=checked><label for=__tabbed_7_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>state</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
<span class=hll>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
</span><span class=hll>    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
</span>    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>
<span class=hll>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
</span><span class=hll>    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
</span>    <span class=kd>private</span> <span class=n>Collection</span><span class=o>&lt;</span><span class=n>IotNode</span><span class=o>&gt;</span> <span class=n>iotNode</span><span class=p>;</span>

    <span class=kd>public</span> <span class=n>Long</span> <span class=nf>getId</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_7 type=radio id=__tabbed_7_2><label for=__tabbed_7_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>state</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>Collection</span><span class=o>&lt;</span><span class=n>IotNode</span><span class=o>&gt;</span> <span class=n>iotNode</span><span class=p>;</span>

    <span class=kd>public</span> <span class=n>Long</span> <span class=nf>getId</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=1.5 template='mkdocs_header_only'  --> <p><br></p> <h4 id=15-json-validacia-dat>1.5 JSON validácia dát <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/95347193e52b26b1cdd501e40be21229f3b5de8a/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#15-json-validacia-dat title="Permanent link">&para;</a></h4> <!--end--> <p>Všetci vieme, že správnosť údajov je dôležitá. Preto pri každom zápise do databázy by sme mali overiť, či prijaté dáta spĺňajú požiadavky napr. email je v správnom tvare, telefónne číslo je v dobrom formáte, zadaný popis nepresahuje maximálnu dĺžku. Toto všetko by sme mohli spraviť manuálnym <code>IF-ELSE</code> spôsobom čo by bolo pracné, chybové a dlhodobo neudržateľné. Našťastie existujú nástroje na zjednodušenie tejto úlohy. V prípade Java prostredia tieto nástroje implementujú štandard JSR 380 a dropwizard obsahuje implementáciu <code>hibernate-validation</code>. Tieto nástroje pracujú na základe anotácii, ktoré definujú požiadavky na danú premennú. <a href=https://www.baeldung.com/javax-validation>Krátky tutoriál na túto tému.</a></p> <!--tgen step=1.5 template='mkdocs_body_only' noupdate  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/95347193e52b26b1cdd501e40be21229f3b5de8a/src/main/java/sk/fri/uniza/model/ContactPerson.java>🖹</a> src/main/java/sk/fri/uniza/model/ContactPerson.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=8:2> <input name=__tabbed_8 type=radio id=__tabbed_8_1 checked=checked><label for=__tabbed_8_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>sk.fri.uniza.model</span><span class=p>;</span>

<span class=hll><span class=kn>import</span> <span class=nn>io.swagger.annotations.ApiModelProperty</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>io.swagger.annotations.ApiParam</span><span class=p>;</span>
</span><span class=kn>import</span> <span class=nn>org.hibernate.validator.constraints.Email</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>org.hibernate.validator.constraints.NotEmpty</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>javax.persistence.Basic</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Embeddable</span><span class=p>;</span>
<span class=hll><span class=kn>import</span> <span class=nn>javax.validation.constraints.NotNull</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>javax.validation.constraints.Pattern</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>javax.validation.constraints.Size</span><span class=p>;</span>
</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ContactPerson</span> <span class=p>{</span>

<span class=hll>    <span class=nd>@NotNull</span>
</span><span class=hll>    <span class=nd>@Size</span><span class=p>(</span><span class=n>min</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>max</span> <span class=o>=</span> <span class=mi>20</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;Janko&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger</span>
</span><span class=hll>    <span class=c1>// dokumentáciu</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>firstName</span><span class=p>;</span>

<span class=hll>    <span class=nd>@NotNull</span>
</span><span class=hll>    <span class=nd>@Size</span><span class=p>(</span><span class=n>min</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=n>max</span> <span class=o>=</span> <span class=mi>20</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;Hraško&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger</span>
</span><span class=hll>    <span class=c1>// dokumentáciu</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>lastName</span><span class=p>;</span>

<span class=hll>    <span class=nd>@NotNull</span>
</span><span class=hll>    <span class=nd>@Pattern</span><span class=p>(</span><span class=n>regexp</span> <span class=o>=</span> <span class=s>&quot;^(\\d{4}[ ]\\d{3}[ ]\\d{3}|\\d{10})$&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=c1>//napr. 0905 123 456 alebo 0905123456</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;0907 123 456&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger</span>
</span><span class=hll>    <span class=c1>// dokumentáciu</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>phone</span><span class=p>;</span>

<span class=hll>    <span class=nd>@NotNull</span>
</span><span class=hll>    <span class=nd>@Email</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;em@mail.sk&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger</span>
</span><span class=hll>    <span class=c1>// dokumentáciu</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>email</span><span class=p>;</span>

    <span class=kd>public</span> <span class=nf>ContactPerson</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_8 type=radio id=__tabbed_8_2><label for=__tabbed_8_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>sk.fri.uniza.model</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>org.hibernate.validator.constraints.Email</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>org.hibernate.validator.constraints.NotEmpty</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>javax.persistence.Basic</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Embeddable</span><span class=p>;</span>


<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ContactPerson</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=n>String</span> <span class=n>firstName</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>String</span> <span class=n>lastName</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>String</span> <span class=n>phone</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>String</span> <span class=n>email</span><span class=p>;</span>

    <span class=kd>public</span> <span class=nf>ContactPerson</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/95347193e52b26b1cdd501e40be21229f3b5de8a/src/main/java/sk/fri/uniza/model/HouseHold.java>🖹</a> src/main/java/sk/fri/uniza/model/HouseHold.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=9:2> <input name=__tabbed_9 type=radio id=__tabbed_9_1 checked=checked><label for=__tabbed_9_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>sk.fri.uniza.model</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>com.fasterxml.jackson.annotation.JsonIgnore</span><span class=p>;</span>
<span class=hll><span class=kn>import</span> <span class=nn>io.swagger.annotations.ApiModelProperty</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>org.hibernate.validator.constraints.NotEmpty</span><span class=p>;</span>
</span>
<span class=kn>import</span> <span class=nn>javax.validation.Valid</span><span class=p>;</span>
<span class=hll><span class=kn>import</span> <span class=nn>javax.validation.constraints.Pattern</span><span class=p>;</span>
</span><span class=kn>import</span> <span class=nn>java.util.Collection</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>


<span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHold</span> <span class=p>{</span>
<span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>hidden</span> <span class=o>=</span> <span class=kc>true</span><span class=p>)</span> <span class=c1>// Swagger nebude zobrazovať atribút</span>
</span>    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
<span class=hll>    <span class=nd>@NotEmpty</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;Univerzitná&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger doku.</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>street</span><span class=p>;</span>
<span class=hll>    <span class=nd>@NotEmpty</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;Žilina&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger doku.</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>city</span><span class=p>;</span>
<span class=hll>    <span class=nd>@NotEmpty</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;Slovakia&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger doku.</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>state</span><span class=p>;</span>
<span class=hll>    <span class=nd>@NotEmpty</span>
</span><span class=hll>    <span class=nd>@Pattern</span><span class=p>(</span><span class=n>regexp</span> <span class=o>=</span> <span class=s>&quot;^\\d*$&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;01008&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger doku.</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Valid</span>
</span>    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
</code></pre></div></div> <input name=__tabbed_9 type=radio id=__tabbed_9_2><label for=__tabbed_9_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>sk.fri.uniza.model</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>com.fasterxml.jackson.annotation.JsonIgnore</span><span class=p>;</span>

<span class=hll><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
</span><span class=kn>import</span> <span class=nn>javax.validation.Valid</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Collection</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>


<span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHold</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>street</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>city</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>state</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
</code></pre></div></div> </div> <p>V prípade deserializácie JSON formátu do Java objektu môžeme vynútiť kontrolu údajov pomocou anotácie <code>@Valid</code>. Ak JSON nieje validný deserializácia skončí výnimkou, ktorá v našom prípade vygeneruje chybovú hlášku, ktorá bude vrátená ako odpoveď na danú požiadavku.</p> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/95347193e52b26b1cdd501e40be21229f3b5de8a/src/main/java/sk/fri/uniza/resources/HouseHoldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/HouseHoldResource.java</strong></p> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=10:2> <input name=__tabbed_10 type=radio id=__tabbed_10_1 checked=checked><label for=__tabbed_10_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@POST</span> <span class=cm>/*JAX-RS*/</span>
    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session // Dropwizard</span>
    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Pridanie novej domácnosti&quot;</span><span class=p>)</span>
<span class=hll>    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>createHouseHold</span><span class=p>(</span><span class=nd>@Valid</span> <span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
</span>        <span class=k>return</span> <span class=n>houshold</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>updateHouseHold</span><span class=p>(</span>
            <span class=n>Long</span> <span class=n>id</span><span class=p>,</span>
<span class=hll>           <span class=nd>@Valid</span> <span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
</span>        <span class=n>houshold</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_10 type=radio id=__tabbed_10_2><label for=__tabbed_10_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@POST</span> <span class=cm>/*JAX-RS*/</span>
    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session // Dropwizard</span>
    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Pridanie novej domácnosti&quot;</span><span class=p>)</span>
<span class=hll>    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>createHouseHold</span><span class=p>(</span><span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
</span>        <span class=k>return</span> <span class=n>houshold</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>updateHouseHold</span><span class=p>(</span>
            <span class=n>Long</span> <span class=n>id</span><span class=p>,</span>
<span class=hll>            <span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
</span>        <span class=n>houshold</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=2.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=20-konfiguracia-databazy>2.0 Konfigúrácia databázy <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/4debc388d0694a1bcc33bdc38def932be6399a3f/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#20-konfiguracia-databazy title="Permanent link">&para;</a></h4> <!--end--> <p>Ako databázu využívame MariaDB čo je OpenSource verzia MySQL databázy. Databáza MariaDB je pri jej prvom spustení nakonfigurovaná a je v nej vytvorená databáza HouseHoldDB a základný administrátor: householduser s heslom userpassword. MariaDB je prístupná na štandardom porte <code>3306</code>.</p> <p>Z pohľadu Dropwizardu je pre nás všetko pripravené, treba iba doplniť konfiguračný súbor <code>config.yml</code> a potrebné údaje, ktoré informujú dropwizard napr. o tom aký ovládač treba použiť, kde sa nachádza databáza, prihlasovacie údaje a pod.</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>V tomto bode ešte treba spomenúť konfiguračnú hodnotu <code>hibernate.hbm2ddl.auto: create</code>, ktorá ako sa dozvieme neskôr, slúži na generovanie databázových tabuliek na základe nášho dátového modelu. Hodnota <code>create</code> má za následok, že zakaždým ako sa spustí aplikácia všetky tabuľky a dáta sa vymažú. Tabuľky sa vytvoria naspäť ale prázdne. Ak je aplikácia hotová a dátový model sa nebude meniť, táto hodnota sa môže zmeniť na <code>none</code>.</p> </div> <!--tgen step=2.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/4debc388d0694a1bcc33bdc38def932be6399a3f/config.yml>🖹</a> config.yml</strong></p> </blockquote> <div class=tabbed-set data-tabs=11:2> <input name=__tabbed_11 type=radio id=__tabbed_11_1 checked=checked><label for=__tabbed_11_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=nt>logging</span><span class=p>:</span>
  <span class=nt>level</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">INFO</span>
  <span class=nt>loggers</span><span class=p>:</span>
    <span class=nt>sk.fri.uniza</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">DEBUG</span>
<span class=hll>
</span><span class=hll><span class=c1># Nastavenie databázy</span>
</span><span class=hll><span class=nt>database</span><span class=p>:</span>
</span><span class=hll>  <span class=c1># názov JDBC ovládača</span>
</span><span class=hll>  <span class=nt>driverClass</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">org.mariadb.jdbc.Driver</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># username</span>
</span><span class=hll>  <span class=nt>user</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">householduser</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># password</span>
</span><span class=hll>  <span class=nt>password</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">userpassword</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># JDBC URL adresa, kde sa nachádza databáza</span>
</span><span class=hll>  <span class=c1># Databáza je spustená cez docker lokálne na porte 3306</span>
</span><span class=hll>  <span class=nt>url</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">jdbc:mariadb://localhost:3306/HouseHoldDB</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># Akékoľvek vlastnosti špecifické pre ovládač JDBC:</span>
</span><span class=hll>  <span class=c1># https://docs.jboss.org/hibernate/orm/5.1/userguide/html_single/Hibernate_User_Guide.html#configurations</span>
</span><span class=hll>  <span class=nt>properties</span><span class=p>:</span>
</span><span class=hll>    <span class=nt>charSet</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">UTF-8</span>
</span><span class=hll>    <span class=nt>hibernate.dialect</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">org.hibernate.dialect.MySQL5Dialect</span> <span class=c1># SQL dialekt, ktorému rozumie databáza</span>
</span><span class=hll>    <span class=nt>hibernate.show_sql</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span> <span class=c1># Do konzoly zapíšte všetky príkazy SQL.</span>
</span><span class=hll>    <span class=nt>hibernate.format_sql</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span> <span class=c1># Pretty-print the SQL in the log and console.</span>
</span><span class=hll>    <span class=nt>hibernate.use_sql_comments</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">true</span> <span class=c1># Ak je pravda, &quot;Hibernácia&quot; generuje komentáre vo vnútri SQL, aby sa uľahčilo ladenie.</span>
</span><span class=hll>    <span class=nt>hibernate.hbm2ddl.auto</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>  <span class=c1># Automatické generovanie schémy (Používa sa pri vývoji, nie v produkčnej verzii)</span>
</span><span class=hll>    <span class=c1>#Možnosti hbm2ddl.auto</span>
</span><span class=hll>    <span class=c1># validate: skontroluje schému, nevykonáva žiadne zmeny v databáze.</span>
</span><span class=hll>    <span class=c1># update: aktualizácia schémy.</span>
</span><span class=hll>    <span class=c1># create: vytvorí schému a zničí predchádzajúce údaje.</span>
</span><span class=hll>    <span class=c1># create-only: Vytvorí sa databáza.</span>
</span><span class=hll>    <span class=c1># create-drop: zruší schému, keď je SessionFactory explicitne zatvorený, zvyčajne pri zastavení aplikácie.</span>
</span><span class=hll>    <span class=c1># none: so schémou nič nerobí, v databáze sa nevykonajú žiadne zmeny</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># Ostatné nastavenia, ktoré sú štandardne nastavené</span>
</span><span class=hll>  <span class=c1># the maximum amount of time to wait on an empty pool before throwing an exception</span>
</span><span class=hll>  <span class=nt>maxWaitForConnection</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1s</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># the SQL query to run when validating a connection&#39;s liveness</span>
</span><span class=hll>  <span class=nt>validationQuery</span><span class=p>:</span> <span class=s>&quot;/*</span><span class=nv> </span><span class=s>MyApplication</span><span class=nv> </span><span class=s>Health</span><span class=nv> </span><span class=s>Check</span><span class=nv> </span><span class=s>*/</span><span class=nv> </span><span class=s>SELECT</span><span class=nv> </span><span class=s>1&quot;</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># the minimum number of connections to keep open</span>
</span><span class=hll>  <span class=nt>minSize</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">8</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># the maximum number of connections to keep open</span>
</span><span class=hll>  <span class=nt>maxSize</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">32</span>
</span><span class=hll>
</span><span class=hll>  <span class=c1># whether or not idle connections should be validated</span>
</span><span class=hll>  <span class=nt>checkConnectionWhileIdle</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</span></code></pre></div></div> <input name=__tabbed_11 type=radio id=__tabbed_11_2><label for=__tabbed_11_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=nl>logging:</span>
  <span class=n>level</span><span class=p>:</span> <span class=n>INFO</span>
  <span class=n>loggers</span><span class=p>:</span>
<span class=hll>    <span class=n>sk</span><span class=p>.</span><span class=na>fri</span><span class=p>.</span><span class=na>uniza</span><span class=p>:</span> <span class=n>DEBUG</span>
</span></code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/4debc388d0694a1bcc33bdc38def932be6399a3f/src/main/java/sk/fri/uniza/HouseHoldServiceConfiguration.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceConfiguration.java</strong></p> <p>public class HouseHoldServiceConfiguration extends Configuration {</p> </blockquote> <div class=tabbed-set data-tabs=12:2> <input name=__tabbed_12 type=radio id=__tabbed_12_1 checked=checked><label for=__tabbed_12_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@JsonProperty</span><span class=p>(</span><span class=s>&quot;swagger&quot;</span><span class=p>)</span>
    <span class=kd>public</span> <span class=n>SwaggerBundleConfiguration</span> <span class=n>swaggerBundleConfiguration</span><span class=p>;</span>

<span class=hll>    <span class=nd>@Valid</span>
</span><span class=hll>    <span class=nd>@NotNull</span>
</span><span class=hll>    <span class=nd>@JsonProperty</span><span class=p>(</span><span class=s>&quot;database&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>DataSourceFactory</span> <span class=n>database</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataSourceFactory</span><span class=p>();</span>
</span><span class=hll>
</span><span class=hll>    <span class=nd>@JsonProperty</span><span class=p>(</span><span class=s>&quot;database&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>DataSourceFactory</span> <span class=nf>getDataSourceFactory</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>database</span><span class=p>;</span>
</span><span class=hll>    <span class=p>}</span>
</span><span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_12 type=radio id=__tabbed_12_2><label for=__tabbed_12_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@JsonProperty</span><span class=p>(</span><span class=s>&quot;swagger&quot;</span><span class=p>)</span>
    <span class=kd>public</span> <span class=n>SwaggerBundleConfiguration</span> <span class=n>swaggerBundleConfiguration</span><span class=p>;</span>

<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=2.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=21-pripojenie-hibernate-orm-kniznice>2.1 Pripojenie Hibernate ORM knižnice <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/7ae3e2e8439d690d18fa822be380691d002bb388/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#21-pripojenie-hibernate-orm-kniznice title="Permanent link">&para;</a></h4> <!--end--> <p>Prístupov ako pracovať s databázou je viacero: počnúc nízko úrovňovým prístup, kedy priamo zapisujeme natívne SQL príkazy a dostávame dáta, ktoré musíme manuálne mapovať na objekty cez polo-automatizované systémy(JDBI) až po plnohodnotné mapovanie Java dátových objektov na databázu (ORM).</p> <p>V tomto prípade budeme používať posledný prístup (ORM), ktorý z pohľadu začiatočníka má najrýchlejšiu krivku učenia. Toto riešenie nám dovolí jednoduchými anotáciami vloženými do dátového modelu vytvoriť komplexnú databázovú štruktúru, ktorá bude priamo mapovaná na dátový model. </p> <p>Problematika ORM(Object-relational mapping) je komplexná a táto úloha veľmi povrchne rieši danú problematiku. </p> <p>Ako nadpis naznačuje tak knižnica ktorú použijeme je Hibernate, čo je opensource knižnica, ktorá je najpoužívanejšia v tejto oblasti. Táto knižnica obsahuje viacej súčastí ako už bolo spomenuté je medzi nimi aj validation knižnica. </p> <p>Hibernate je implementácia štandardu <a href=https://www.javatpoint.com/jpa-tutorial>JPA</a>. Tento štandard je plne obsiahnutý v tejto knižnici, ale knižnica ponúka aj vlastné rozšírenia. </p> <!--tgen step=2.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/7ae3e2e8439d690d18fa822be380691d002bb388/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=13:2> <input name=__tabbed_13 type=radio id=__tabbed_13_1 checked=checked><label for=__tabbed_13_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHoldServiceApplication</span>
        <span class=kd>extends</span> <span class=n>Application</span><span class=o>&lt;</span><span class=n>HouseHoldServiceConfiguration</span><span class=o>&gt;</span> <span class=p>{</span>

<span class=hll>    <span class=c1>// Vytvorenie Hibernate baliká: tento balík kombinuje objekt určený na</span>
</span><span class=hll>    <span class=c1>// nastavenie Hibernat a samotnú knižnicu Hibernate</span>
</span><span class=hll>    <span class=kd>private</span> <span class=kd>final</span> <span class=n>HibernateBundle</span><span class=o>&lt;</span><span class=n>HouseHoldServiceConfiguration</span><span class=o>&gt;</span> <span class=n>hibernate</span> <span class=o>=</span>
</span><span class=hll>            <span class=c1>// Všetky triedy(v žargóne Hibernate sú označované ako Entity),</span>
</span><span class=hll>            <span class=c1>// ktoré tvoria model musia byť prídané do Bundle</span>
</span><span class=hll>            <span class=k>new</span> <span class=n>HibernateBundle</span><span class=o>&lt;</span><span class=n>HouseHoldServiceConfiguration</span><span class=o>&gt;</span><span class=p>(</span>
</span><span class=hll>                    <span class=n>HouseHold</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                    <span class=n>IotNode</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                    <span class=n>Field</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                    <span class=n>DataDouble</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                    <span class=n>DataString</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                    <span class=n>DataInteger</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                    <span class=n>ContactPerson</span><span class=p>.</span><span class=na>class</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                <span class=nd>@Override</span>
</span><span class=hll>                <span class=kd>public</span> <span class=n>DataSourceFactory</span> <span class=nf>getDataSourceFactory</span><span class=p>(</span>
</span><span class=hll>                        <span class=n>HouseHoldServiceConfiguration</span> <span class=n>configuration</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                    <span class=k>return</span> <span class=n>configuration</span><span class=p>.</span><span class=na>getDataSourceFactory</span><span class=p>();</span>
</span><span class=hll>                <span class=p>}</span>
</span><span class=hll>            <span class=p>};</span>
</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=k>new</span> <span class=n>HouseHoldServiceApplication</span><span class=p>().</span><span class=na>run</span><span class=p>(</span><span class=n>args</span><span class=p>);</span>
</code></pre></div></div> <input name=__tabbed_13 type=radio id=__tabbed_13_2><label for=__tabbed_13_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHoldServiceApplication</span>
        <span class=kd>extends</span> <span class=n>Application</span><span class=o>&lt;</span><span class=n>HouseHoldServiceConfiguration</span><span class=o>&gt;</span> <span class=p>{</span>


    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=p>(</span><span class=kd>final</span> <span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=k>new</span> <span class=n>HouseHoldServiceApplication</span><span class=p>().</span><span class=na>run</span><span class=p>(</span><span class=n>args</span><span class=p>);</span>
</code></pre></div></div> </div> <blockquote> <p>public void initialize(</p> </blockquote> <div class=tabbed-set data-tabs=14:2> <input name=__tabbed_14 type=radio id=__tabbed_14_1 checked=checked><label for=__tabbed_14_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>            <span class=p>}</span>
        <span class=p>});</span>

<span class=hll>        <span class=c1>// Pripojený balík Hibernate (ORM databáza)</span>
</span><span class=hll>        <span class=n>bootstrap</span><span class=p>.</span><span class=na>addBundle</span><span class=p>(</span><span class=n>hibernate</span><span class=p>);</span>
</span><span class=hll>
</span>    <span class=p>}</span>

    <span class=c1>// V rámci životného cyklu, je táto metóda zavolaná až po metóde initialize.</span>
</code></pre></div></div> <input name=__tabbed_14 type=radio id=__tabbed_14_2><label for=__tabbed_14_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>            <span class=p>}</span>
        <span class=p>});</span>

    <span class=p>}</span>

    <span class=c1>// V rámci životného cyklu, je táto metóda zavolaná až po metóde initialize.</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=3.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=30-vytvorenie-datoveho-modelu-trieda-household>3.0 Vytvorenie dátového modelu trieda: HouseHold <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/04399a9a3ab31ed09f650c71a3ab7c17bde51111/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#30-vytvorenie-datoveho-modelu-trieda-household title="Permanent link">&para;</a></h4> <!--end--> <p><img alt src=../images/3.0_ER.png#center></p> <p>V danom prípade máme daný dátový model, ktorý reprezentuje Trieda <code>HouseHold</code> ako domácnosť, ktorá má jednu kontaktnú osobu trieda <code>ContactPerson</code>. Tento dátový model by sme chceli namapovať na databázovú schému tak aby bola obsiahnutá v jednej tabuľke. Za týmto účelom se definujeme <code>ContactPerson</code> ako <code>@Embeddable</code> to znamená, že bude nedeliteľnou súčasťou inej triedy. </p> <p>Hlavnú triedu <code>HouseHold</code> anotujeme ako <code>@Entity</code> čím definujeme, že bude tvoriť základ tabuľky. <strong>Každá trieda, ktorá má byť súčasnou ORM musí byť anotovaná ako <code>@Entity</code> alebo <code>@Embeddable</code>.</strong> </p> <p>Anotáciou <code>@Id</code> definujeme primárny kľúč tabuľky. Na vytvorenie primárneho kľúča využijem vlastnosť auto-generovania <code>@GeneratedValue(strategy = GenerationType.IDENTITY)</code>.</p> <div class="admonition note"> <p class=admonition-title><code>@Transient</code></p> <p>Ak je niečo označené ako <code>@Transient</code> ORM daný atribút ignoruje. Niktoré atribúty sú tak dočasne označené by sa dala aplikácia v každom kroku spustiť. </p> </div> <p>Výsledkom po spustení je vytvorená tabuľka v databáze:</p> <p><img alt src=../images/Screenshot_20200518_214012.png#center></p> <p>Obsah databázy si môžete prezrieť pomocou databázového prehliadača ku ktorému je prístup z pravého bočného menu (prístup do databázy je v tomto projekte už nakonfigurovaný). </p> <!--tgen step=3.0 template='mkdocs_body_only' --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/04399a9a3ab31ed09f650c71a3ab7c17bde51111/src/main/java/sk/fri/uniza/model/ContactPerson.java>🖹</a> src/main/java/sk/fri/uniza/model/ContactPerson.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=15:2> <input name=__tabbed_15 type=radio id=__tabbed_15_1 checked=checked><label for=__tabbed_15_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.validation.constraints.Pattern</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.validation.constraints.Size</span><span class=p>;</span>

<span class=hll><span class=nd>@Embeddable</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ContactPerson</span> <span class=p>{</span>

    <span class=nd>@NotNull</span>
</code></pre></div></div> <input name=__tabbed_15 type=radio id=__tabbed_15_2><label for=__tabbed_15_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.validation.constraints.Pattern</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.validation.constraints.Size</span><span class=p>;</span>

<span class=hll>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ContactPerson</span> <span class=p>{</span>

    <span class=nd>@NotNull</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/04399a9a3ab31ed09f650c71a3ab7c17bde51111/src/main/java/sk/fri/uniza/model/HouseHold.java>🖹</a> src/main/java/sk/fri/uniza/model/HouseHold.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=16:2> <input name=__tabbed_16 type=radio id=__tabbed_16_1 checked=checked><label for=__tabbed_16_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>io.swagger.annotations.ApiModelProperty</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>org.hibernate.validator.constraints.NotEmpty</span><span class=p>;</span>

<span class=hll><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
</span><span class=kn>import</span> <span class=nn>javax.validation.Valid</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.validation.constraints.Pattern</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Collection</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>

<span class=hll><span class=nd>@Entity</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHold</span> <span class=p>{</span>
<span class=hll>    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@Id</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>accessMode</span> <span class=o>=</span> <span class=n>ApiModelProperty</span><span class=p>.</span><span class=na>AccessMode</span><span class=p>.</span><span class=na>READ_ONLY</span><span class=p>)</span>
</span><span class=hll>    <span class=c1>// Swagger nebude zobrazovať atribút</span>
</span>    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
    <span class=nd>@NotEmpty</span>
    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;Univerzitná&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger doku.</span>
</code></pre></div></div> <input name=__tabbed_16 type=radio id=__tabbed_16_2><label for=__tabbed_16_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>io.swagger.annotations.ApiModelProperty</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>org.hibernate.validator.constraints.NotEmpty</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>javax.validation.Valid</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.validation.constraints.Pattern</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Collection</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>

<span class=hll>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHold</span> <span class=p>{</span>
<span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>hidden</span> <span class=o>=</span> <span class=kc>true</span><span class=p>)</span> <span class=c1>// Swagger nebude zobrazovať atribút</span>
</span>    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
    <span class=nd>@NotEmpty</span>
    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;Univerzitná&quot;</span><span class=p>)</span> <span class=c1>// Príklad pre swagger doku.</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHold {</p> </blockquote> <div class=tabbed-set data-tabs=17:2> <input name=__tabbed_17 type=radio id=__tabbed_17_1 checked=checked><label for=__tabbed_17_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
    <span class=nd>@Valid</span>
    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Transient</span>
</span>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Transient</span>
</span>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
    <span class=kd>private</span> <span class=n>Collection</span><span class=o>&lt;</span><span class=n>IotNode</span><span class=o>&gt;</span> <span class=n>iotNode</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_17 type=radio id=__tabbed_17_2><label for=__tabbed_17_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
    <span class=nd>@Valid</span>
    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>
    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
    <span class=kd>private</span> <span class=n>Collection</span><span class=o>&lt;</span><span class=n>IotNode</span><span class=o>&gt;</span> <span class=n>iotNode</span><span class=p>;</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=3.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=31-vytvorenie-pristupoveho-objektu-do-databazy-householddao>3.1 Vytvorenie prístupového objektu do databázy: HouseHoldDAO <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/b63bda99beb1f8961bddf67c728a5be75aa63ea2/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#31-vytvorenie-pristupoveho-objektu-do-databazy-householddao title="Permanent link">&para;</a></h4> <!--end--> <p>DAO (data access object) je vo voľnom preklade objekt určený na prístup k dáta. Po dátami sa rozumie dáta v uložené v databáze a pod prístupom sa rozumejú základné CRUD(create, read, update, delete) operácie. Tento objekt má za úlohu vniesť abstrakciu k prístupu k dátam v databáze. Dropwizard má pripravenú abstraktnú triedu <code>AbstractDAO</code>, ktorá ma zjednodušiť vytváranie DAO prístupových tried. </p> <blockquote> <p><strong>Trieda AbstractDAO</strong> <img alt src=../images/3.1DAO.png#center></p> </blockquote> <p><br></p> <p>Nato aby ORM efektívne a bezpečne pracovalo z databázou využíva pri prístupe tzv. session(spojenie). Pred prácou s databázou sa session musí nadviazať a po skončení sa session zruší. Efektívnosť sa dosahuje napríklad tým, že operácie modifikácie dát sa reálne zapíšu naraz až po ukončení session. Bezpečnosť sa dá zabezpečiť tým, že počas vytvorenej session sa zablokuje prístup k používaným dátam a tým pádom nikto iný v rovnaký čas nemôže pristupovať k rovnakým dátam. V rámci Dropwizardu je vytvorená session vždy nadviazaná pri začiatku obsluhy HTTP požiadavky a ukončená je po jej spracovaní a odoslaní odpovede. Metóda ktorá takúto obsluhu vykonáva musí byť anotováná ako <code>@UnitOfWork</code>.</p> <blockquote> <p><strong>Komunikácia cez DAO objekt</strong> <img alt src=../diagrams/out/DAO.svg#center></p> </blockquote> <!--tgen step=3.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/b63bda99beb1f8961bddf67c728a5be75aa63ea2/src/main/java/sk/fri/uniza/db/HouseHoldDAO.java>🖹</a> src/main/java/sk/fri/uniza/db/HouseHoldDAO.java</strong></p> <p>public class HouseHoldDAO extends AbstractDAO<household> {</p> </blockquote> <div class=tabbed-set data-tabs=18:2> <input name=__tabbed_18 type=radio id=__tabbed_18_1 checked=checked><label for=__tabbed_18_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>create</span><span class=p>(</span><span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=n>currentSession</span><span class=p>().</span><span class=na>save</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>houseHold</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>update</span><span class=p>(</span><span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=p>(</span><span class=n>HouseHold</span><span class=p>)</span> <span class=n>currentSession</span><span class=p>().</span><span class=na>merge</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByZip</span><span class=p>(</span><span class=n>String</span> <span class=n>zip</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_18 type=radio id=__tabbed_18_2><label for=__tabbed_18_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>create</span><span class=p>(</span><span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>update</span><span class=p>(</span><span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByZip</span><span class=p>(</span><span class=n>String</span> <span class=n>zip</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldDAO extends AbstractDAO<household> {</p> </blockquote> <div class=tabbed-set data-tabs=19:2> <input name=__tabbed_19 type=radio id=__tabbed_19_1 checked=checked><label for=__tabbed_19_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>findById</span><span class=p>(</span><span class=n>Long</span> <span class=n>ID</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>get</span><span class=p>(</span><span class=n>ID</span><span class=p>);</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findAll</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_19 type=radio id=__tabbed_19_2><label for=__tabbed_19_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>findById</span><span class=p>(</span><span class=n>Long</span> <span class=n>ID</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findAll</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=3.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=32-otestovanie-zapisu-do-databazy-householddao>3.2 Otestovanie zápisu do databázy: HouseHoldDAO <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/82f8ccdfa7fad8d081b04f179553c0c3858a6ecc/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#32-otestovanie-zapisu-do-databazy-householddao title="Permanent link">&para;</a></h4> <!--end--> <p>Na otestovanie funkčnosti DAO objektu použijeme priami programátorský prístup. Túto skúšku spravíme v triede <code>DatabaseHealthCheck</code>, ktorá je zavolaná až keď je všetko správne inicializované.</p> <p>Výsledok úspešného testu je, že v databáze pribudne jeden záznam:</p> <p><img alt src=../images/Screenshot_20200518_215422.png#center></p> <!--tgen step=3.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/82f8ccdfa7fad8d081b04f179553c0c3858a6ecc/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=20:2> <input name=__tabbed_20 type=radio id=__tabbed_20_1 checked=checked><label for=__tabbed_20_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=p>(</span><span class=kd>final</span> <span class=n>HouseHoldServiceConfiguration</span> <span class=n>configuration</span><span class=p>,</span>
                    <span class=kd>final</span> <span class=n>Environment</span> <span class=n>environment</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=c1>// Vytvorené objekty na prístup k databáze</span>
</span><span class=hll>        <span class=kd>final</span> <span class=n>HouseHoldDAO</span> <span class=n>houseHoldDAO</span> <span class=o>=</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>HouseHoldDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>
</span>
        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>HouseHoldResource</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=kc>null</span><span class=p>));</span>
<span class=hll>
</span><span class=hll>        <span class=c1>// Vytvorenie Healthcheck (overenie zdravia aplikácie), ktorý</span>
</span><span class=hll>        <span class=c1>// využijeme na otestovanie databázy</span>
</span><span class=hll>        <span class=kd>final</span> <span class=n>DatabaseHealthCheck</span> <span class=n>databaseHealthCheck</span> <span class=o>=</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>UnitOfWorkAwareProxyFactory</span><span class=p>(</span><span class=n>hibernate</span><span class=p>)</span>
</span><span class=hll>                        <span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>DatabaseHealthCheck</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                                <span class=k>new</span> <span class=n>Class</span><span class=o>[]</span><span class=p>{</span><span class=n>HouseHoldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                                        <span class=n>IotNodeDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                                        <span class=n>DataDAO</span><span class=p>.</span><span class=na>class</span><span class=p>},</span>
</span><span class=hll>                                <span class=k>new</span> <span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>,</span>
</span><span class=hll>                                        <span class=kc>null</span><span class=p>,</span> <span class=kc>null</span>
</span><span class=hll>                                <span class=p>});</span>
</span><span class=hll>        <span class=c1>// Zaregistrovanie Healthcheck</span>
</span><span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
</span><span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=s>&quot;databaseHealthcheck&quot;</span><span class=p>,</span> <span class=n>databaseHealthCheck</span><span class=p>);</span>
</span><span class=hll>        <span class=c1>// Spustenie všetkých health kontrol</span>
</span><span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>().</span><span class=na>runHealthChecks</span><span class=p>();</span>
</span><span class=hll>
</span>    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_20 type=radio id=__tabbed_20_2><label for=__tabbed_20_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>run</span><span class=p>(</span><span class=kd>final</span> <span class=n>HouseHoldServiceConfiguration</span> <span class=n>configuration</span><span class=p>,</span>
                    <span class=kd>final</span> <span class=n>Environment</span> <span class=n>environment</span><span class=p>)</span> <span class=p>{</span>

        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>HouseHoldResource</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=kc>null</span><span class=p>));</span>
    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/82f8ccdfa7fad8d081b04f179553c0c3858a6ecc/src/main/java/sk/fri/uniza/health/DatabaseHealthCheck.java>🖹</a> src/main/java/sk/fri/uniza/health/DatabaseHealthCheck.java</strong></p> <p>public class DatabaseHealthCheck extends HealthCheck {</p> </blockquote> <div class=tabbed-set data-tabs=21:2> <input name=__tabbed_21 type=radio id=__tabbed_21_1 checked=checked><label for=__tabbed_21_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=nd>@UnitOfWork</span>
    <span class=kd>protected</span> <span class=n>Result</span> <span class=nf>check</span><span class=p>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
<span class=hll>        <span class=c1>// Testovanie, či už v databáze neexstuje Household</span>
</span><span class=hll>        <span class=n>HouseHold</span> <span class=n>holdDAOById</span> <span class=o>=</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>findById</span><span class=p>((</span><span class=kt>long</span><span class=p>)</span> <span class=mi>1</span><span class=p>);</span>
</span><span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=n>holdDAOById</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=na>healthy</span><span class=p>();</span>
</span><span class=hll>        <span class=n>HouseHold</span> <span class=n>houseHold</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HouseHold</span><span class=p>();</span>
</span><span class=hll>        <span class=n>houseHold</span><span class=p>.</span><span class=na>setCity</span><span class=p>(</span><span class=s>&quot;Žilina&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>houseHold</span><span class=p>.</span><span class=na>setState</span><span class=p>(</span><span class=s>&quot;Slovakia&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>houseHold</span><span class=p>.</span><span class=na>setStreet</span><span class=p>(</span><span class=s>&quot;Okružná&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>houseHold</span><span class=p>.</span><span class=na>setZip</span><span class=p>(</span><span class=s>&quot;01001&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>houseHold</span><span class=p>.</span><span class=na>setContactPerson</span><span class=p>(</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>ContactPerson</span><span class=p>(</span><span class=s>&quot;Ferko&quot;</span><span class=p>,</span> <span class=s>&quot;Mrkvicka&quot;</span><span class=p>,</span>
</span><span class=hll>                        <span class=s>&quot;0907888777&quot;</span><span class=p>,</span> <span class=s>&quot;f.mrkvicka@fri.uniza.sk&quot;</span><span class=p>));</span>
</span><span class=hll>        <span class=n>houseHold</span> <span class=o>=</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>
</span><span class=hll>
</span>        <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=na>healthy</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_21 type=radio id=__tabbed_21_2><label for=__tabbed_21_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=nd>@UnitOfWork</span>
    <span class=kd>protected</span> <span class=n>Result</span> <span class=nf>check</span><span class=p>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=na>healthy</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=3.3 template='mkdocs_header_only'  --> <p><br></p> <h4 id=33-pristup-do-databazy-cez-dao-v-householdresource>3.3 Prístup do dátabázy cez DAO v HouseHoldResource <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/c563a53e9a23d44fa31f47ed9f3652c160475002/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#33-pristup-do-databazy-cez-dao-v-householdresource title="Permanent link">&para;</a></h4> <!--end--> <p>Po vytvorení databázovej schémy a DAO prístupového objektu je načase ich použiť na vytvorenie REST rozhrania, ktoré bude pracovať s databázou.</p> <!--tgen step=3.3 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/c563a53e9a23d44fa31f47ed9f3652c160475002/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=22:2> <input name=__tabbed_22 type=radio id=__tabbed_22_1 checked=checked><label for=__tabbed_22_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
<span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>HouseHoldResource</span><span class=p>(</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>));</span>
</span>
        <span class=c1>// Vytvorenie Healthcheck (overenie zdravia aplikácie), ktorý</span>
        <span class=c1>// využijeme na otestovanie databázy</span>
</code></pre></div></div> <input name=__tabbed_22 type=radio id=__tabbed_22_2><label for=__tabbed_22_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
<span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>HouseHoldResource</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=kc>null</span><span class=p>));</span>
</span>
        <span class=c1>// Vytvorenie Healthcheck (overenie zdravia aplikácie), ktorý</span>
        <span class=c1>// využijeme na otestovanie databázy</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/c563a53e9a23d44fa31f47ed9f3652c160475002/src/main/java/sk/fri/uniza/resources/HouseHoldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/HouseHoldResource.java</strong></p> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=23:2> <input name=__tabbed_23 type=radio id=__tabbed_23_1 checked=checked><label for=__tabbed_23_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session // Dropwizard</span>
    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Pridanie novej domácnosti&quot;</span><span class=p>)</span>
    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>createHouseHold</span><span class=p>(</span><span class=nd>@Valid</span> <span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>houshold</span><span class=p>);</span>
</span>    <span class=p>}</span>

<span class=hll>    <span class=nd>@PUT</span> <span class=cm>/*JAX-RS*/</span>
</span><span class=hll>    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{id}&quot;</span><span class=p>)</span> <span class=cm>/*JAX-RS*/</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session // Dropwizard</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Úprava existujúcej domácnosti&quot;</span><span class=p>)</span>
</span>    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>updateHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=nd>@ApiParam</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;ID&quot;</span><span class=p>,</span> <span class=n>required</span> <span class=o>=</span> <span class=kc>true</span><span class=p>)</span> <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>Long</span> <span class=n>id</span><span class=p>,</span>
</span><span class=hll>            <span class=nd>@Valid</span> <span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
</span>        <span class=n>houshold</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
<span class=hll>        <span class=k>return</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>update</span><span class=p>(</span><span class=n>houshold</span><span class=p>);</span>
</span>    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_23 type=radio id=__tabbed_23_2><label for=__tabbed_23_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session // Dropwizard</span>
    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Pridanie novej domácnosti&quot;</span><span class=p>)</span>
    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>createHouseHold</span><span class=p>(</span><span class=nd>@Valid</span> <span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>houshold</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>updateHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=n>Long</span> <span class=n>id</span><span class=p>,</span>
</span><span class=hll>           <span class=nd>@Valid</span> <span class=n>HouseHold</span> <span class=n>houshold</span><span class=p>)</span> <span class=p>{</span>
</span>        <span class=n>houshold</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=24:2> <input name=__tabbed_24 type=radio id=__tabbed_24_1 checked=checked><label for=__tabbed_24_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Údaje o konkrétnej domácnosť&quot;</span><span class=p>)</span>
    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>getHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=nd>@ApiParam</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;ID&quot;</span><span class=p>,</span> <span class=n>required</span> <span class=o>=</span> <span class=kc>true</span><span class=p>)</span> <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>Long</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
</span>    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_24 type=radio id=__tabbed_24_2><label for=__tabbed_24_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Údaje o konkrétnej domácnosť&quot;</span><span class=p>)</span>
    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>getHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=nd>@ApiParam</span><span class=p>(</span><span class=n>required</span> <span class=o>=</span> <span class=kc>true</span><span class=p>)</span>
</span><span class=hll>            <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>Long</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=k>new</span> <span class=n>HouseHold</span><span class=p>();</span>
</span>    <span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=4.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=40-filtrovanievyhladavanie-v-databaze-pomocou-namedquery>4.0 Filtrovanie/vyhľadávanie v databáze pomocou NamedQuery <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/512651d5e50f7abd60f59f159b67102fc4fc0243/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#40-filtrovanievyhladavanie-v-databaze-pomocou-namedquery title="Permanent link">&para;</a></h4> <!--end--> <p>Pri práci s databázou ak chceme niečo vyhľadať musíme napísať SQL príkaz, ktorý získa požadované dáta. V prípade ORM to nieje inak. Zložitejšie filtrovanie sa musí spraviť cez JPQL alebo SQL jazyk a výsledné dáta sú poskytnuté vo forme Java objektov. SQL je natívny jazyk databázy a JPQL je jazyk ORM, ktorý je v konečnom dôsledku preložený do SQL. JQPL má jednoduchšiu štruktúru a pracuje s Java mapovaním. V našom prípade keďže používame hibernate nám pribudla možnosť použiť HQL jazyk, ktorý je rozšírením štandardného JQPL.</p> <p>Hlavnou nevýhodou rozptýlenia skriptov HQL a SQL v DAO objektoch je to, že kód je nečitateľný. Preto má zmysel zoskupiť všetky HQL a SQL na jednom mieste a nato nám slúžia <code>NamedQuery</code>.</p> <p><a href=https://www.baeldung.com/hibernate-named-query>Viac o tejto téme tu.</a></p> <!--tgen step=4.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/512651d5e50f7abd60f59f159b67102fc4fc0243/src/main/java/sk/fri/uniza/model/HouseHold.java>🖹</a> src/main/java/sk/fri/uniza/model/HouseHold.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=25:2> <input name=__tabbed_25 type=radio id=__tabbed_25_1 checked=checked><label for=__tabbed_25_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>java.util.Collection</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>

<span class=hll><span class=nd>@org.hibernate.annotations.NamedQueries</span><span class=p>({</span>
</span><span class=hll>        <span class=nd>@org.hibernate.annotations.NamedQuery</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;HouseHold_findByZip&quot;</span><span class=p>,</span>
</span><span class=hll>                <span class=n>query</span> <span class=o>=</span> <span class=s>&quot;from HouseHold where zip = :zipNo&quot;</span><span class=p>),</span>
</span><span class=hll>        <span class=nd>@org.hibernate.annotations.NamedQuery</span><span class=p>(</span>
</span><span class=hll>                <span class=n>name</span> <span class=o>=</span> <span class=s>&quot;HouseHold_findByFirstName&quot;</span><span class=p>,</span>
</span><span class=hll>                <span class=n>query</span> <span class=o>=</span> <span class=s>&quot;from HouseHold where firstname = :name&quot;</span><span class=p>),</span>
</span><span class=hll>        <span class=nd>@org.hibernate.annotations.NamedQuery</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;HouseHold_findLastName&quot;</span><span class=p>,</span>
</span><span class=hll>                <span class=n>query</span> <span class=o>=</span> <span class=s>&quot;from HouseHold where lastname = :name&quot;</span><span class=p>),</span>
</span><span class=hll>        <span class=nd>@org.hibernate.annotations.NamedQuery</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;HouseHold_findAll&quot;</span><span class=p>,</span>
</span><span class=hll>                <span class=n>query</span> <span class=o>=</span> <span class=s>&quot;from HouseHold&quot;</span><span class=p>),</span>
</span><span class=hll>
</span><span class=hll><span class=p>})</span>
</span><span class=nd>@Entity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHold</span> <span class=p>{</span>
    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
</code></pre></div></div> <input name=__tabbed_25 type=radio id=__tabbed_25_2><label for=__tabbed_25_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>java.util.Collection</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>HouseHold</span> <span class=p>{</span>
    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=4.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=41-pouzitie-namedquery-v-dao-objekte>4.1 Použitie NamedQuery v DAO objekte <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/122f5245bc00a36c73a9114ec48b39ac662b6611/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#41-pouzitie-namedquery-v-dao-objekte title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=4.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/122f5245bc00a36c73a9114ec48b39ac662b6611/src/main/java/sk/fri/uniza/db/HouseHoldDAO.java>🖹</a> src/main/java/sk/fri/uniza/db/HouseHoldDAO.java</strong></p> <p>public class HouseHoldDAO extends AbstractDAO<household> {</p> </blockquote> <div class=tabbed-set data-tabs=26:2> <input name=__tabbed_26 type=radio id=__tabbed_26_1 checked=checked><label for=__tabbed_26_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByZip</span><span class=p>(</span><span class=n>String</span> <span class=n>zip</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>list</span><span class=p>(</span><span class=n>namedQuery</span><span class=p>(</span><span class=s>&quot;HouseHold_findByZip&quot;</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&quot;zipNo&quot;</span><span class=p>,</span> <span class=n>zip</span><span class=p>));</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByFirstName</span><span class=p>(</span><span class=n>String</span> <span class=n>firstname</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>list</span><span class=p>(</span><span class=n>namedQuery</span><span class=p>(</span><span class=s>&quot;HouseHold_findByFirstName&quot;</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&quot;name&quot;</span><span class=p>,</span> <span class=n>firstname</span><span class=p>));</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByLastName</span><span class=p>(</span><span class=n>String</span> <span class=n>lastname</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>list</span><span class=p>(</span><span class=n>namedQuery</span><span class=p>(</span><span class=s>&quot;HouseHold_findByLastName&quot;</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&quot;name&quot;</span><span class=p>,</span> <span class=n>lastname</span><span class=p>));</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>findById</span><span class=p>(</span><span class=n>Long</span> <span class=n>ID</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_26 type=radio id=__tabbed_26_2><label for=__tabbed_26_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByZip</span><span class=p>(</span><span class=n>String</span> <span class=n>zip</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByFirstName</span><span class=p>(</span><span class=n>String</span> <span class=n>firstname</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findByLastName</span><span class=p>(</span><span class=n>String</span> <span class=n>lastname</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>HouseHold</span> <span class=nf>findById</span><span class=p>(</span><span class=n>Long</span> <span class=n>ID</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldDAO extends AbstractDAO<household> {</p> </blockquote> <div class=tabbed-set data-tabs=27:2> <input name=__tabbed_27 type=radio id=__tabbed_27_1 checked=checked><label for=__tabbed_27_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findAll</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>list</span><span class=p>(</span><span class=n>namedQuery</span><span class=p>(</span><span class=s>&quot;HouseHold_findAll&quot;</span><span class=p>));</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_27 type=radio id=__tabbed_27_2><label for=__tabbed_27_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>findAll</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=4.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=42-aplikovanie-dao-filtrov-v-householdresource>4.2 Aplikovanie DAO filtrov v HouseHoldResource <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/90b722893dd3fd7fe1fb5bd69fcfb808b5540a56/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#42-aplikovanie-dao-filtrov-v-householdresource title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=4.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/90b722893dd3fd7fe1fb5bd69fcfb808b5540a56/src/main/java/sk/fri/uniza/resources/HouseHoldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/HouseHoldResource.java</strong></p> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=28:2> <input name=__tabbed_28 type=radio id=__tabbed_28_1 checked=checked><label for=__tabbed_28_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>


<span class=hll>    <span class=nd>@GET</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Zoznam všetkých domácnosti&quot;</span><span class=p>)</span>
</span>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>listHouseHold</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>findAll</span><span class=p>();</span>
</span>    <span class=p>}</span>

    <span class=nd>@GET</span>
</code></pre></div></div> <input name=__tabbed_28 type=radio id=__tabbed_28_2><label for=__tabbed_28_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>


    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>listHouseHold</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@GET</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=29:2> <input name=__tabbed_29 type=radio id=__tabbed_29_1 checked=checked><label for=__tabbed_29_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>


<span class=hll>    <span class=nd>@GET</span>
</span><span class=hll>    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;filter&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Vyfiltrovaný zoznam domácnosti&quot;</span><span class=p>)</span>
</span>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>filterHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=nd>@QueryParam</span><span class=p>(</span><span class=s>&quot;filter&quot;</span><span class=p>)</span> <span class=n>FilterEnum</span> <span class=n>filter</span><span class=p>,</span>
</span><span class=hll>            <span class=nd>@QueryParam</span><span class=p>(</span><span class=s>&quot;value&quot;</span><span class=p>)</span> <span class=n>String</span> <span class=n>value</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>
</span><span class=hll>        <span class=k>switch</span> <span class=p>(</span><span class=n>filter</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>zip</span><span class=p>:</span>
</span><span class=hll>                <span class=k>return</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>findByZip</span><span class=p>(</span><span class=n>value</span><span class=p>);</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>firstName</span><span class=p>:</span>
</span><span class=hll>                <span class=k>return</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>findByFirstName</span><span class=p>(</span><span class=n>value</span><span class=p>);</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>lastName</span><span class=p>:</span>
</span><span class=hll>                <span class=k>return</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>findByLastName</span><span class=p>(</span><span class=n>value</span><span class=p>);</span>
</span><span class=hll>        <span class=p>}</span>
</span>
        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_29 type=radio id=__tabbed_29_2><label for=__tabbed_29_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>


    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>HouseHold</span><span class=o>&gt;</span> <span class=nf>filterHouseHold</span><span class=p>(</span>
<span class=hll>            <span class=n>FilterEnum</span> <span class=n>filter</span><span class=p>,</span>
</span><span class=hll>            <span class=n>String</span> <span class=n>value</span><span class=p>)</span> <span class=p>{</span>
</span>
        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=5.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=50-dedicnost-s-orm-pristupom>5.0 Dedičnosť s ORM prístupom <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/868d556210bcc7c777881f81b74e20069fc527b3/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#50-dedicnost-s-orm-pristupom title="Permanent link">&para;</a></h4> <!--end--> <p>Dedičnosť a polymorfizmus je súčasnou objektového programovania. Relačné databázy nemajú priamy mechanizmus ako mapovať hierarchiu objektov. Pre vyriešenie tohoto problému <a href=https://www.baeldung.com/hibernate-inheritance>JPA štandard definuje štyri prístupy</a>:</p> <ul> <li><em>MappedSuperclass</em> - rodičovské triedy, nemôžu byť entity</li> <li><em>Single Table</em> - entity z rôznych tried so spoločným predkom sú umiestnené v jednej tabuľke</li> <li><em>Joined Table</em> - každá trieda má svoju tabuľku a dotazovanie podtriedy vyžaduje pripojenie tabuliek (join)</li> <li><em>Table-Per-Class</em> -v tejto stratégii sa rodičovská trieda a jej pod-triedy v hierarchii mapujú do rôznych jednotlivých tabuliek.</li> </ul> <p>V našom prípade budeme využívať stratégiu jednej tabuľky (single table). Keďže záznamy zo všetkých objektov budú obsiahnuté v jednej tabuľke hibernate potrebuje každému riadku vedieť priradiť správny java objekt. Na túto úlohu hibernate v tabuľke pridaná nový stĺpec tzv. diskriminátor, štandardný názov stĺpca je <code>DTYPE</code>, ktorý slúži na rozlíšenie o aký objekt sa jedná. </p> <blockquote> <p>Požadovaná hierarchická štruktúra java objektov <img alt src=../images/5.0_dedicnost.png#center></p> </blockquote> <p><br></p> <blockquote> <p>Výsledná databázová schéma</p> <p><img alt src=../images/5.1_dedicnost_DB.png#center></p> </blockquote> <!--tgen step=5.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/868d556210bcc7c777881f81b74e20069fc527b3/src/main/java/sk/fri/uniza/model/AbstractData.java>🖹</a> src/main/java/sk/fri/uniza/model/AbstractData.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=30:2> <input name=__tabbed_30 type=radio id=__tabbed_30_1 checked=checked><label for=__tabbed_30_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.time.LocalDateTime</span><span class=p>;</span>
<span class=hll><span class=nd>@Entity</span>
</span><span class=hll><span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span>
</span><span class=kd>public</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>AbstractData</span><span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=p>{</span>
<span class=hll>    <span class=nd>@Id</span>
</span><span class=hll>    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>accessMode</span> <span class=o>=</span> <span class=n>ApiModelProperty</span><span class=p>.</span><span class=na>AccessMode</span><span class=p>.</span><span class=na>READ_ONLY</span><span class=p>)</span>
</span>    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Transient</span>
</span>    <span class=kd>private</span> <span class=n>Field</span> <span class=n>field</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Transient</span>
</span>    <span class=kd>private</span> <span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>LocalDateTime</span> <span class=n>dateTime</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_30 type=radio id=__tabbed_30_2><label for=__tabbed_30_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.time.LocalDateTime</span><span class=p>;</span>
<span class=hll>
</span><span class=kd>public</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>AbstractData</span><span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=p>{</span>
<span class=hll>
</span>    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
<span class=hll>
</span>    <span class=kd>private</span> <span class=n>Field</span> <span class=n>field</span><span class=p>;</span>
<span class=hll>
</span>    <span class=kd>private</span> <span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>LocalDateTime</span> <span class=n>dateTime</span><span class=p>;</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/868d556210bcc7c777881f81b74e20069fc527b3/src/main/java/sk/fri/uniza/model/DataDouble.java>🖹</a> src/main/java/sk/fri/uniza/model/DataDouble.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=31:2> <input name=__tabbed_31 type=radio id=__tabbed_31_1 checked=checked><label for=__tabbed_31_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Column</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=hll><span class=nd>@Entity</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataDouble</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span> <span class=p>{</span>

<span class=hll>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;double_value&quot;</span><span class=p>)</span>
</span>    <span class=kd>private</span> <span class=n>Double</span> <span class=n>value</span><span class=p>;</span>

    <span class=nd>@Override</span>
</code></pre></div></div> <input name=__tabbed_31 type=radio id=__tabbed_31_2><label for=__tabbed_31_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Column</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataDouble</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span> <span class=p>{</span>

<span class=hll>
</span>    <span class=kd>private</span> <span class=n>Double</span> <span class=n>value</span><span class=p>;</span>

    <span class=nd>@Override</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/868d556210bcc7c777881f81b74e20069fc527b3/src/main/java/sk/fri/uniza/model/DataInteger.java>🖹</a> src/main/java/sk/fri/uniza/model/DataInteger.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=32:2> <input name=__tabbed_32 type=radio id=__tabbed_32_1 checked=checked><label for=__tabbed_32_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Column</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=hll><span class=nd>@Entity</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataInteger</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=p>{</span>

<span class=hll>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;integer_value&quot;</span><span class=p>)</span>
</span>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>Value</span><span class=p>;</span>

    <span class=nd>@Override</span>
</code></pre></div></div> <input name=__tabbed_32 type=radio id=__tabbed_32_2><label for=__tabbed_32_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Column</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataInteger</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>Value</span><span class=p>;</span>

    <span class=nd>@Override</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/868d556210bcc7c777881f81b74e20069fc527b3/src/main/java/sk/fri/uniza/model/DataString.java>🖹</a> src/main/java/sk/fri/uniza/model/DataString.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=33:2> <input name=__tabbed_33 type=radio id=__tabbed_33_1 checked=checked><label for=__tabbed_33_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Column</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=hll><span class=nd>@Entity</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataString</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=p>{</span>

<span class=hll>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;string_value&quot;</span><span class=p>)</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>value</span><span class=p>;</span>

    <span class=nd>@Override</span>
</code></pre></div></div> <input name=__tabbed_33 type=radio id=__tabbed_33_2><label for=__tabbed_33_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Column</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=hll>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataString</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=p>{</span>

<span class=hll>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>value</span><span class=p>;</span>

    <span class=nd>@Override</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=5.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=51-uprava-datadao-objektu>5.1 Úprava DataDAO objektu <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/1e41f27da4974451e015d1bc1d49b2d35ffdec2e/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#51-uprava-datadao-objektu title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=5.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/1e41f27da4974451e015d1bc1d49b2d35ffdec2e/src/main/java/sk/fri/uniza/db/DataDAO.java>🖹</a> src/main/java/sk/fri/uniza/db/DataDAO.java</strong></p> <p>public class DataDAO extends AbstractDAO<abstractdata> {</p> </blockquote> <div class=tabbed-set data-tabs=34:2> <input name=__tabbed_34 type=radio id=__tabbed_34_1 checked=checked><label for=__tabbed_34_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>create</span><span class=p>(</span><span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=n>currentSession</span><span class=p>().</span><span class=na>save</span><span class=p>(</span><span class=n>data</span><span class=p>);</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>data</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=nf>findData</span><span class=p>(</span><span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span> <span class=n>String</span> <span class=n>fieldId</span><span class=p>,</span>
</code></pre></div></div> <input name=__tabbed_34 type=radio id=__tabbed_34_2><label for=__tabbed_34_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>create</span><span class=p>(</span><span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=nf>findData</span><span class=p>(</span><span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span> <span class=n>String</span> <span class=n>fieldId</span><span class=p>,</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=5.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=52-otestovanie-novych-datovy-objektov>5.2 Otestovanie nových dátový objektov <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/46de15469df534948210fe86f89afb5774417122/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#52-otestovanie-novych-datovy-objektov title="Permanent link">&para;</a></h4> <!--end--> <p>Úspešný test by mal v databáze vytvoriť tri nové záznamy:</p> <p><img alt src=../images/Screenshot_20200518_235313.png#center></p> <!--tgen step=5.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/46de15469df534948210fe86f89afb5774417122/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=35:2> <input name=__tabbed_35 type=radio id=__tabbed_35_1 checked=checked><label for=__tabbed_35_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorené objekty na prístup k databáze</span>
        <span class=kd>final</span> <span class=n>HouseHoldDAO</span> <span class=n>houseHoldDAO</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>HouseHoldDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>
<span class=hll>        <span class=kd>final</span> <span class=n>DataDAO</span> <span class=n>dataDAO</span> <span class=o>=</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>DataDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>
</span>
        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
</code></pre></div></div> <input name=__tabbed_35 type=radio id=__tabbed_35_2><label for=__tabbed_35_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorené objekty na prístup k databáze</span>
        <span class=kd>final</span> <span class=n>HouseHoldDAO</span> <span class=n>houseHoldDAO</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>HouseHoldDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>

        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=36:2> <input name=__tabbed_36 type=radio id=__tabbed_36_1 checked=checked><label for=__tabbed_36_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                                        <span class=n>IotNodeDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                        <span class=n>DataDAO</span><span class=p>.</span><span class=na>class</span><span class=p>},</span>
                                <span class=k>new</span> <span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>,</span>
<span class=hll>                                        <span class=kc>null</span><span class=p>,</span> <span class=n>dataDAO</span>
</span>                                <span class=p>});</span>
        <span class=c1>// Zaregistrovanie Healthcheck</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
</code></pre></div></div> <input name=__tabbed_36 type=radio id=__tabbed_36_2><label for=__tabbed_36_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                                        <span class=n>IotNodeDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                        <span class=n>DataDAO</span><span class=p>.</span><span class=na>class</span><span class=p>},</span>
                                <span class=k>new</span> <span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>,</span>
<span class=hll>                                        <span class=kc>null</span><span class=p>,</span> <span class=kc>null</span>
</span>                                <span class=p>});</span>
        <span class=c1>// Zaregistrovanie Healthcheck</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/46de15469df534948210fe86f89afb5774417122/src/main/java/sk/fri/uniza/health/DatabaseHealthCheck.java>🖹</a> src/main/java/sk/fri/uniza/health/DatabaseHealthCheck.java</strong></p> <p>public class DatabaseHealthCheck extends HealthCheck {</p> </blockquote> <div class=tabbed-set data-tabs=37:2> <input name=__tabbed_37 type=radio id=__tabbed_37_1 checked=checked><label for=__tabbed_37_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                        <span class=s>&quot;0907888777&quot;</span><span class=p>,</span> <span class=s>&quot;f.mrkvicka@fri.uniza.sk&quot;</span><span class=p>));</span>
        <span class=n>houseHold</span> <span class=o>=</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>

<span class=hll>        <span class=n>DataDouble</span> <span class=n>dataDouble</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataDouble</span><span class=p>();</span>
</span><span class=hll>        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=mf>10.5</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>DataInteger</span> <span class=n>dataInteger</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataInteger</span><span class=p>();</span>
</span><span class=hll>        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>DataString</span> <span class=n>dataString</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataString</span><span class=p>();</span>
</span><span class=hll>        <span class=n>dataString</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=s>&quot;Slnecno&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataString</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>dataDouble</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>dataInteger</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>dataString</span><span class=p>);</span>
</span><span class=hll>
</span>        <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=na>healthy</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_37 type=radio id=__tabbed_37_2><label for=__tabbed_37_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                        <span class=s>&quot;0907888777&quot;</span><span class=p>,</span> <span class=s>&quot;f.mrkvicka@fri.uniza.sk&quot;</span><span class=p>));</span>
        <span class=n>houseHold</span> <span class=o>=</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>

        <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=na>healthy</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=5.3 template='mkdocs_header_only'  --> <p><br></p> <h4 id=53-dedicnost-pri-pouziti-json-serializaciedeserializacie>5.3 Dedičnosť pri použití JSON serializácie/deserializácie <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/1710ac9889ed9f6e942ab1b61e15565425d06b52/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#53-dedicnost-pri-pouziti-json-serializaciedeserializacie title="Permanent link">&para;</a></h4> <!--end--> <p>S dedičnosťou nastáva problém aj pri serializácia/deserializácii pri JSON formáte. Podobný princíp ako sme použili v prípade ORM existuje aj v tomto prípade, kedy sa pri serializácii pridá do JSON objektu aj informácia o aký typ objektu sa jedná. V opačnom prípade deserializácie sa táto informácia využije na vytvorenie toho správneho objektu. <a href=https://www.baeldung.com/jackson-inheritance>Viac informácií tu.</a></p> <!--tgen step=5.3 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/1710ac9889ed9f6e942ab1b61e15565425d06b52/src/main/java/sk/fri/uniza/model/AbstractData.java>🖹</a> src/main/java/sk/fri/uniza/model/AbstractData.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=38:2> <input name=__tabbed_38 type=radio id=__tabbed_38_1 checked=checked><label for=__tabbed_38_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>java.time.LocalDateTime</span><span class=p>;</span>
<span class=nd>@Entity</span>
<span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span>
<span class=hll>
</span><span class=hll><span class=nd>@JsonTypeInfo</span><span class=p>(</span>
</span><span class=hll>        <span class=n>use</span> <span class=o>=</span> <span class=n>JsonTypeInfo</span><span class=p>.</span><span class=na>Id</span><span class=p>.</span><span class=na>NAME</span><span class=p>,</span>
</span><span class=hll>        <span class=n>include</span> <span class=o>=</span> <span class=n>JsonTypeInfo</span><span class=p>.</span><span class=na>As</span><span class=p>.</span><span class=na>PROPERTY</span><span class=p>,</span>
</span><span class=hll>        <span class=n>property</span> <span class=o>=</span> <span class=s>&quot;type&quot;</span><span class=p>)</span>
</span><span class=hll><span class=nd>@JsonSubTypes</span><span class=p>({</span>
</span><span class=hll>        <span class=nd>@JsonSubTypes.Type</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=n>DataDouble</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s>&quot;double&quot;</span><span class=p>),</span>
</span><span class=hll>        <span class=nd>@JsonSubTypes.Type</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=n>DataInteger</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s>&quot;integer&quot;</span><span class=p>),</span>
</span><span class=hll>        <span class=nd>@JsonSubTypes.Type</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=n>DataString</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s>&quot;string&quot;</span><span class=p>)</span>
</span><span class=hll><span class=p>})</span>
</span><span class=hll><span class=c1>// Slúži iba na tvorbu swagger dokumentácie</span>
</span><span class=hll><span class=nd>@ApiModel</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Data&quot;</span><span class=p>,</span> <span class=n>discriminator</span> <span class=o>=</span> <span class=s>&quot;type&quot;</span><span class=p>,</span> <span class=n>subTypes</span> <span class=o>=</span> <span class=p>{</span><span class=n>DataDouble</span><span class=p>.</span><span class=na>class</span>
</span><span class=hll>        <span class=p>,</span> <span class=n>DataInteger</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>        <span class=n>DataString</span><span class=p>.</span><span class=na>class</span><span class=p>})</span>
</span><span class=kd>public</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>AbstractData</span><span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=p>{</span>
    <span class=nd>@Id</span>
    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
</code></pre></div></div> <input name=__tabbed_38 type=radio id=__tabbed_38_2><label for=__tabbed_38_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>java.time.LocalDateTime</span><span class=p>;</span>
<span class=nd>@Entity</span>
<span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span>
<span class=kd>public</span> <span class=kd>abstract</span> <span class=kd>class</span> <span class=nc>AbstractData</span><span class=o>&lt;</span><span class=n>T</span> <span class=kd>extends</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=p>{</span>
    <span class=nd>@Id</span>
    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/1710ac9889ed9f6e942ab1b61e15565425d06b52/src/main/java/sk/fri/uniza/model/DataDouble.java>🖹</a> src/main/java/sk/fri/uniza/model/DataDouble.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=39:2> <input name=__tabbed_39 type=radio id=__tabbed_39_1 checked=checked><label for=__tabbed_39_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=hll><span class=nd>@JsonTypeName</span><span class=p>(</span><span class=s>&quot;double&quot;</span><span class=p>)</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataDouble</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span> <span class=p>{</span>

    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;double_value&quot;</span><span class=p>)</span>
</code></pre></div></div> <input name=__tabbed_39 type=radio id=__tabbed_39_2><label for=__tabbed_39_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataDouble</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span> <span class=p>{</span>

    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;double_value&quot;</span><span class=p>)</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/1710ac9889ed9f6e942ab1b61e15565425d06b52/src/main/java/sk/fri/uniza/model/DataInteger.java>🖹</a> src/main/java/sk/fri/uniza/model/DataInteger.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=40:2> <input name=__tabbed_40 type=radio id=__tabbed_40_1 checked=checked><label for=__tabbed_40_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=hll><span class=nd>@JsonTypeName</span><span class=p>(</span><span class=s>&quot;integer&quot;</span><span class=p>)</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataInteger</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=p>{</span>

    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;integer_value&quot;</span><span class=p>)</span>
</code></pre></div></div> <input name=__tabbed_40 type=radio id=__tabbed_40_2><label for=__tabbed_40_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataInteger</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=p>{</span>

    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;integer_value&quot;</span><span class=p>)</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/1710ac9889ed9f6e942ab1b61e15565425d06b52/src/main/java/sk/fri/uniza/model/DataString.java>🖹</a> src/main/java/sk/fri/uniza/model/DataString.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=41:2> <input name=__tabbed_41 type=radio id=__tabbed_41_1 checked=checked><label for=__tabbed_41_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=hll><span class=nd>@JsonTypeName</span><span class=p>(</span><span class=s>&quot;string&quot;</span><span class=p>)</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataString</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=p>{</span>

    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;string_value&quot;</span><span class=p>)</span>
</code></pre></div></div> <input name=__tabbed_41 type=radio id=__tabbed_41_2><label for=__tabbed_41_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.Entity</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>DataString</span> <span class=kd>extends</span> <span class=n>AbstractData</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=p>{</span>

    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;string_value&quot;</span><span class=p>)</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=5.4 template='mkdocs_header_only'  --> <p><br></p> <h4 id=54-json-deserializacia-casovych-udajov>5.4 JSON deserializácia časových údajov <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/3136ac67900c2616e26f253bee041bfd3e7825a9/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#54-json-deserializacia-casovych-udajov title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=5.4 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/3136ac67900c2616e26f253bee041bfd3e7825a9/src/main/java/sk/fri/uniza/model/AbstractData.java>🖹</a> src/main/java/sk/fri/uniza/model/AbstractData.java</strong></p> <p>public abstract class AbstractData<t extends object> {</p> </blockquote> <div class=tabbed-set data-tabs=42:2> <input name=__tabbed_42 type=radio id=__tabbed_42_1 checked=checked><label for=__tabbed_42_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Transient</span>
    <span class=kd>private</span> <span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>;</span>

<span class=hll>    <span class=nd>@JsonFormat</span><span class=p>(</span><span class=n>shape</span> <span class=o>=</span> <span class=n>JsonFormat</span><span class=p>.</span><span class=na>Shape</span><span class=p>.</span><span class=na>STRING</span><span class=p>,</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s>&quot;dd/MM/yyyy HH:mm&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>example</span> <span class=o>=</span> <span class=s>&quot;31/01/2020 14:00&quot;</span><span class=p>)</span>
</span>    <span class=kd>private</span> <span class=n>LocalDateTime</span> <span class=n>dateTime</span><span class=p>;</span>

    <span class=kd>public</span> <span class=n>Long</span> <span class=nf>getId</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_42 type=radio id=__tabbed_42_2><label for=__tabbed_42_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Transient</span>
    <span class=kd>private</span> <span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>LocalDateTime</span> <span class=n>dateTime</span><span class=p>;</span>

    <span class=kd>public</span> <span class=n>Long</span> <span class=nf>getId</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=6.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=60-vytvorenie-vztahu-many-to-many>6.0 Vytvorenie vzťahu Many-to-Many <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/976f6c96a03f49d97a20990f786a45aa41acd082/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#60-vytvorenie-vztahu-many-to-many title="Permanent link">&para;</a></h4> <!--end--> <p>Vzťah je prepojenie dvoch entít navzájom a v tomto prípade sa jedná o prepojenie many-to-many čo znamená, že každá strana môže obsahovať viacej inštancií. </p> <p><img alt src=../images/6.0_ER_MANY-TO-MANY.png#center></p> <p><em>Houshold</em> môže obsahovať veľa dát a tieto dáta zároveň môžu byť rôzneho typu <em>Field</em>. Takýto komplexný vzťah rozložíme na jeho parciálne časti: </p> <table> <thead> <tr> <th align=center>Trieda<br><em>Strana "Many" - vlastník vzťahu</em></th> <th align=center>Obojsmerný vzťah</th> <th align=center>Trieda<br><em>Strana "ONE"</em></th> </tr> </thead> <tbody> <tr> <td align=center><code>HouseHold</code></td> <td align=center>⟵(many-to-one)⟶</td> <td align=center><code>AbstractData</code></td> </tr> <tr> <td align=center><code>Field</code></td> <td align=center>⟵(many-to-one)⟶</td> <td align=center><code>AbstractData</code></td> </tr> </tbody> </table> <table> <thead> <tr> <th align=center><em>Strana "Many"</em></th> <th align=center>Obojsmerný vzťah</th> <th align=center><em>Strana "Many"</em></th> </tr> </thead> <tbody> <tr> <td align=center></td> <td align=center><strong>Virtuálne nám vznikne vzťah ⟵(many-to-many)⟶</strong></td> <td align=center></td> </tr> <tr> <td align=center><code>HouseHold</code></td> <td align=center>⟵(many-to-one)⟶<code>AbstractData</code>⟵(one-to-many)⟶</td> <td align=center><code>Field</code></td> </tr> </tbody> </table> <p><a href=https://www.baeldung.com/jpa-many-to-many>Viac o vytvorení takéhoto vzťahu sa dozviete tu.</a></p> <div class="admonition note"> <p class=admonition-title>Eager/Lazy načítavanie v Hibernate</p> <p>Pri práci s ORM možno načítať údaje dvoma spôsobmi: Eager/Lazy v preklade nedočkavé a lenivé.</p> <ul> <li> <p><code>Eager</code> je návrhový vzor, ​​pri ktorom dochádza k inicializácii dát ihneď. Napríklad ak máme vytvorený vzťah medzi dvoma objektami tvorený v databáze dvoma tabuľkami tak pri načítaní jedného objektu sa načítajú dáta aj do druhého objektu.</p> </li> <li> <p><code>Lazy</code> je návrhový vzor, ktorý sa používa na odloženie inicializácie objektu, pokiaľ je to možné. Napríklad ak máme vytvorený vzťah medzi dvoma objektami tvorený v databáze dvoma tabuľkami tak pri načítaní jedného objektu sa načítajú iba jeho dáta a o dáta spriazneného objektu si musíme požiadať samostatné.</p> </li> </ul> <p>Voľba módu <code>Eager</code> ovplyvňuje výkonnosť a treba s ním pracovať opatrne. Môže dochádzať k automatickému načítavaniu obrovského množstva dát, ktoré vôbec nie sú potrebné. <a href=https://www.baeldung.com/hibernate-lazy-eager-loading>Viac informácii najdete tu</a></p> </div> <!--tgen step=6.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/976f6c96a03f49d97a20990f786a45aa41acd082/src/main/java/sk/fri/uniza/model/AbstractData.java>🖹</a> src/main/java/sk/fri/uniza/model/AbstractData.java</strong></p> <p>public abstract class AbstractData<t extends object> {</p> </blockquote> <div class=tabbed-set data-tabs=43:2> <input name=__tabbed_43 type=radio id=__tabbed_43_1 checked=checked><label for=__tabbed_43_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>accessMode</span> <span class=o>=</span> <span class=n>ApiModelProperty</span><span class=p>.</span><span class=na>AccessMode</span><span class=p>.</span><span class=na>READ_ONLY</span><span class=p>)</span>
    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
<span class=hll>
</span><span class=hll>    <span class=nd>@ManyToOne</span><span class=p>(</span><span class=n>fetch</span> <span class=o>=</span> <span class=n>FetchType</span><span class=p>.</span><span class=na>EAGER</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;field_id&quot;</span><span class=p>,</span> <span class=n>nullable</span> <span class=o>=</span> <span class=kc>false</span><span class=p>)</span>
</span>    <span class=kd>private</span> <span class=n>Field</span> <span class=n>field</span><span class=p>;</span>
<span class=hll>
</span><span class=hll>    <span class=nd>@ManyToOne</span><span class=p>(</span><span class=n>fetch</span> <span class=o>=</span> <span class=n>FetchType</span><span class=p>.</span><span class=na>EAGER</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;household_id&quot;</span><span class=p>,</span> <span class=n>nullable</span> <span class=o>=</span> <span class=kc>false</span><span class=p>)</span>
</span>    <span class=kd>private</span> <span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>;</span>

    <span class=nd>@JsonFormat</span><span class=p>(</span><span class=n>shape</span> <span class=o>=</span> <span class=n>JsonFormat</span><span class=p>.</span><span class=na>Shape</span><span class=p>.</span><span class=na>STRING</span><span class=p>,</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s>&quot;dd/MM/yyyy HH:mm&quot;</span><span class=p>)</span>
</code></pre></div></div> <input name=__tabbed_43 type=radio id=__tabbed_43_2><label for=__tabbed_43_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span>
    <span class=nd>@ApiModelProperty</span><span class=p>(</span><span class=n>accessMode</span> <span class=o>=</span> <span class=n>ApiModelProperty</span><span class=p>.</span><span class=na>AccessMode</span><span class=p>.</span><span class=na>READ_ONLY</span><span class=p>)</span>
    <span class=kd>private</span> <span class=n>Long</span> <span class=n>id</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Transient</span>
</span>    <span class=kd>private</span> <span class=n>Field</span> <span class=n>field</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Transient</span>
</span>    <span class=kd>private</span> <span class=n>HouseHold</span> <span class=n>houseHold</span><span class=p>;</span>

    <span class=nd>@JsonFormat</span><span class=p>(</span><span class=n>shape</span> <span class=o>=</span> <span class=n>JsonFormat</span><span class=p>.</span><span class=na>Shape</span><span class=p>.</span><span class=na>STRING</span><span class=p>,</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s>&quot;dd/MM/yyyy HH:mm&quot;</span><span class=p>)</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/976f6c96a03f49d97a20990f786a45aa41acd082/src/main/java/sk/fri/uniza/model/Field.java>🖹</a> src/main/java/sk/fri/uniza/model/Field.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=44:2> <input name=__tabbed_44 type=radio id=__tabbed_44_1 checked=checked><label for=__tabbed_44_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.validation.constraints.Size</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>

<span class=hll><span class=nd>@Entity</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Field</span> <span class=p>{</span>
<span class=hll>    <span class=nd>@Id</span>
</span><span class=hll>    <span class=nd>@NaturalId</span> <span class=c1>//Primárny klúč nie je generovaný, ale je tvorený názvom premennej</span>
</span><span class=hll>    <span class=nd>@NotEmpty</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>String</span> <span class=n>unit</span><span class=p>;</span>

<span class=hll>    <span class=nd>@NotEmpty</span>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>descripton</span><span class=p>;</span>

<span class=hll>    <span class=nd>@OneToMany</span><span class=p>(</span><span class=n>fetch</span> <span class=o>=</span> <span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>,</span>
</span><span class=hll>            <span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&quot;field&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
</span><span class=hll>    <span class=c1>// objektu JSON.Generoval by sa obrovský JSON a dochádzalo by aj k</span>
</span><span class=hll>    <span class=c1>// zacykleniu</span>
</span>    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>

    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getName</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_44 type=radio id=__tabbed_44_2><label for=__tabbed_44_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.validation.constraints.Size</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Field</span> <span class=p>{</span>
<span class=hll>
</span><span class=hll>
</span>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>String</span> <span class=n>unit</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>String</span> <span class=n>descripton</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>

    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getName</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/976f6c96a03f49d97a20990f786a45aa41acd082/src/main/java/sk/fri/uniza/model/HouseHold.java>🖹</a> src/main/java/sk/fri/uniza/model/HouseHold.java</strong></p> <p>public class HouseHold {</p> </blockquote> <div class=tabbed-set data-tabs=45:2> <input name=__tabbed_45 type=radio id=__tabbed_45_1 checked=checked><label for=__tabbed_45_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
    <span class=nd>@Valid</span>
    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
<span class=hll>
</span><span class=hll>    <span class=nd>@OneToMany</span><span class=p>(</span><span class=n>fetch</span> <span class=o>=</span> <span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>,</span>
</span><span class=hll>            <span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&quot;houseHold&quot;</span><span class=p>)</span>
</span>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
<span class=hll>    <span class=c1>// objektu JSON. Generoval by sa obrovský JSON a dochádzalo by aj k</span>
</span><span class=hll>    <span class=c1>// zacykleniu</span>
</span>    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>
<span class=hll>
</span>    <span class=nd>@Transient</span>
    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
</code></pre></div></div> <input name=__tabbed_45 type=radio id=__tabbed_45_2><label for=__tabbed_45_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>zip</span><span class=p>;</span>
    <span class=nd>@Valid</span>
    <span class=kd>private</span> <span class=n>ContactPerson</span> <span class=n>contactPerson</span><span class=p>;</span>
<span class=hll>    <span class=nd>@Transient</span>
</span>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
<span class=hll>    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
</span>    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=n>data</span><span class=p>;</span>
    <span class=nd>@Transient</span>
    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// Objektu JSON.Gneroval by sa obrovský JSON a dochádzalo by aj k zacykleniu</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=6.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=61-uprava-fielddao-triedy>6.1 Úprava FieldDAO triedy <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/122aa471d3dda56638447bc40d2fe97c5c3566f7/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#61-uprava-fielddao-triedy title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=6.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/122aa471d3dda56638447bc40d2fe97c5c3566f7/src/main/java/sk/fri/uniza/db/FieldDAO.java>🖹</a> src/main/java/sk/fri/uniza/db/FieldDAO.java</strong></p> <p>public class FieldDAO extends AbstractDAO<field> {</p> </blockquote> <div class=tabbed-set data-tabs=46:2> <input name=__tabbed_46 type=radio id=__tabbed_46_1 checked=checked><label for=__tabbed_46_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>create</span><span class=p>(</span><span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=n>currentSession</span><span class=p>().</span><span class=na>save</span><span class=p>(</span><span class=n>field</span><span class=p>);</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>field</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>update</span><span class=p>(</span><span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=p>(</span><span class=n>Field</span><span class=p>)</span> <span class=n>currentSession</span><span class=p>().</span><span class=na>merge</span><span class=p>(</span><span class=n>field</span><span class=p>);</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>findById</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>get</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
</span>    <span class=p>}</span>

<span class=hll>
</span>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>delete</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_46 type=radio id=__tabbed_46_2><label for=__tabbed_46_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>create</span><span class=p>(</span><span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>update</span><span class=p>(</span><span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>findById</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>delete</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=6.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=62-otestovanie-vytvoreneho-vztahu-many-to-many>6.2 Otestovanie vytvoreného vzťahu Many-To-many <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/7cd7862e522db1541cda01d72ccda931214d2e00/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#62-otestovanie-vytvoreneho-vztahu-many-to-many title="Permanent link">&para;</a></h4> <!--end--> <p>Úspešný výsledok testu v tabuľke <em>AbstractData</em> vytvorí nasledovné hodnoty:</p> <p><img alt src=../images/Screenshot_20200519_013831.png></p> <!--tgen step=6.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/7cd7862e522db1541cda01d72ccda931214d2e00/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=47:2> <input name=__tabbed_47 type=radio id=__tabbed_47_1 checked=checked><label for=__tabbed_47_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                <span class=k>new</span> <span class=n>HouseHoldDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>
        <span class=kd>final</span> <span class=n>DataDAO</span> <span class=n>dataDAO</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>DataDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>
<span class=hll>        <span class=kd>final</span> <span class=n>FieldDAO</span> <span class=n>fieldDAO</span> <span class=o>=</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>FieldDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>
</span>
        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
</code></pre></div></div> <input name=__tabbed_47 type=radio id=__tabbed_47_2><label for=__tabbed_47_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                <span class=k>new</span> <span class=n>HouseHoldDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>
        <span class=kd>final</span> <span class=n>DataDAO</span> <span class=n>dataDAO</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>DataDAO</span><span class=p>(</span><span class=n>hibernate</span><span class=p>.</span><span class=na>getSessionFactory</span><span class=p>());</span>

        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=48:2> <input name=__tabbed_48 type=radio id=__tabbed_48_1 checked=checked><label for=__tabbed_48_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                                        <span class=n>IotNodeDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                        <span class=n>DataDAO</span><span class=p>.</span><span class=na>class</span><span class=p>},</span>
                                <span class=k>new</span> <span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>,</span>
<span class=hll>                                        <span class=n>fieldDAO</span><span class=p>,</span> <span class=n>dataDAO</span>
</span>                                <span class=p>});</span>
        <span class=c1>// Zaregistrovanie Healthcheck</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
</code></pre></div></div> <input name=__tabbed_48 type=radio id=__tabbed_48_2><label for=__tabbed_48_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                                        <span class=n>IotNodeDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                        <span class=n>DataDAO</span><span class=p>.</span><span class=na>class</span><span class=p>},</span>
                                <span class=k>new</span> <span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>,</span>
<span class=hll>                                        <span class=kc>null</span><span class=p>,</span> <span class=n>dataDAO</span>
</span>                                <span class=p>});</span>
        <span class=c1>// Zaregistrovanie Healthcheck</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/7cd7862e522db1541cda01d72ccda931214d2e00/src/main/java/sk/fri/uniza/health/DatabaseHealthCheck.java>🖹</a> src/main/java/sk/fri/uniza/health/DatabaseHealthCheck.java</strong></p> <p>public class DatabaseHealthCheck extends HealthCheck {</p> </blockquote> <div class=tabbed-set data-tabs=49:2> <input name=__tabbed_49 type=radio id=__tabbed_49_1 checked=checked><label for=__tabbed_49_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>houseHold</span><span class=p>.</span><span class=na>setStreet</span><span class=p>(</span><span class=s>&quot;Okružná&quot;</span><span class=p>);</span>
        <span class=n>houseHold</span><span class=p>.</span><span class=na>setZip</span><span class=p>(</span><span class=s>&quot;01001&quot;</span><span class=p>);</span>
        <span class=n>houseHold</span><span class=p>.</span><span class=na>setContactPerson</span><span class=p>(</span>
<span class=hll>                <span class=k>new</span> <span class=n>ContactPerson</span><span class=p>(</span><span class=s>&quot;Ferko&quot;</span><span class=p>,</span> <span class=s>&quot;Mrkvička&quot;</span><span class=p>,</span>
</span>                        <span class=s>&quot;0907888777&quot;</span><span class=p>,</span> <span class=s>&quot;f.mrkvicka@fri.uniza.sk&quot;</span><span class=p>));</span>
        <span class=n>houseHold</span> <span class=o>=</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>

<span class=hll>        <span class=n>Field</span> <span class=n>airTemp</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Field</span><span class=p>();</span>
</span><span class=hll>        <span class=n>airTemp</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=s>&quot;airTemp&quot;</span><span class=p>);</span> <span class=c1>//NativeId - musí sa vytvoriť manuálne</span>
</span><span class=hll>        <span class=n>airTemp</span><span class=p>.</span><span class=na>setUnit</span><span class=p>(</span><span class=s>&quot;°C&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>airTemp</span><span class=p>.</span><span class=na>setDescripton</span><span class=p>(</span><span class=s>&quot;Teplota vzduchu&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>airTemp</span> <span class=o>=</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>airTemp</span><span class=p>);</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>Field</span> <span class=n>windSpeed</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Field</span><span class=p>();</span>
</span><span class=hll>        <span class=n>windSpeed</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=s>&quot;windSpeed&quot;</span><span class=p>);</span> <span class=c1>//NativeId - musí sa vytvoriť manuálne</span>
</span><span class=hll>        <span class=n>windSpeed</span><span class=p>.</span><span class=na>setUnit</span><span class=p>(</span><span class=s>&quot;m/s&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>windSpeed</span><span class=p>.</span><span class=na>setDescripton</span><span class=p>(</span><span class=s>&quot;Rýchlosť vetra&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>windSpeed</span> <span class=o>=</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>windSpeed</span><span class=p>);</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>Field</span> <span class=n>weather</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Field</span><span class=p>();</span>
</span><span class=hll>        <span class=n>weather</span><span class=p>.</span><span class=na>setName</span><span class=p>(</span><span class=s>&quot;weather&quot;</span><span class=p>);</span> <span class=c1>//NativeId - musí sa vytvoriť manuálne</span>
</span><span class=hll>        <span class=n>weather</span><span class=p>.</span><span class=na>setDescripton</span><span class=p>(</span><span class=s>&quot;Aktuálne počasie&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>weather</span> <span class=o>=</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>weather</span><span class=p>);</span>
</span><span class=hll>
</span>        <span class=n>DataDouble</span> <span class=n>dataDouble</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataDouble</span><span class=p>();</span>
        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=mf>10.5</span><span class=p>);</span>
        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>
<span class=hll>        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setField</span><span class=p>(</span><span class=n>airTemp</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setHouseHold</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>
</span>
        <span class=n>DataInteger</span> <span class=n>dataInteger</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataInteger</span><span class=p>();</span>
        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>
<span class=hll>        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setField</span><span class=p>(</span><span class=n>windSpeed</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setHouseHold</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>
</span>
        <span class=n>DataString</span> <span class=n>dataString</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataString</span><span class=p>();</span>
<span class=hll>        <span class=n>dataString</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=s>&quot;Slnečno&quot;</span><span class=p>);</span>
</span>        <span class=n>dataString</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>
<span class=hll>        <span class=n>dataString</span><span class=p>.</span><span class=na>setField</span><span class=p>(</span><span class=n>weather</span><span class=p>);</span>
</span><span class=hll>        <span class=n>dataString</span><span class=p>.</span><span class=na>setHouseHold</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>
</span>
        <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>dataDouble</span><span class=p>);</span>
        <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>dataInteger</span><span class=p>);</span>
</code></pre></div></div> <input name=__tabbed_49 type=radio id=__tabbed_49_2><label for=__tabbed_49_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>houseHold</span><span class=p>.</span><span class=na>setStreet</span><span class=p>(</span><span class=s>&quot;Okružná&quot;</span><span class=p>);</span>
        <span class=n>houseHold</span><span class=p>.</span><span class=na>setZip</span><span class=p>(</span><span class=s>&quot;01001&quot;</span><span class=p>);</span>
        <span class=n>houseHold</span><span class=p>.</span><span class=na>setContactPerson</span><span class=p>(</span>
<span class=hll>                <span class=k>new</span> <span class=n>ContactPerson</span><span class=p>(</span><span class=s>&quot;Ferko&quot;</span><span class=p>,</span> <span class=s>&quot;Mrkvicka&quot;</span><span class=p>,</span>
</span>                        <span class=s>&quot;0907888777&quot;</span><span class=p>,</span> <span class=s>&quot;f.mrkvicka@fri.uniza.sk&quot;</span><span class=p>));</span>
        <span class=n>houseHold</span> <span class=o>=</span> <span class=n>houseHoldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>

        <span class=n>DataDouble</span> <span class=n>dataDouble</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataDouble</span><span class=p>();</span>
        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=mf>10.5</span><span class=p>);</span>
        <span class=n>dataDouble</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>

        <span class=n>DataInteger</span> <span class=n>dataInteger</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataInteger</span><span class=p>();</span>
        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
        <span class=n>dataInteger</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>

        <span class=n>DataString</span> <span class=n>dataString</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DataString</span><span class=p>();</span>
<span class=hll>        <span class=n>dataString</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=s>&quot;Slnecno&quot;</span><span class=p>);</span>
</span>        <span class=n>dataString</span><span class=p>.</span><span class=na>setDateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span>

        <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>dataDouble</span><span class=p>);</span>
        <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>dataInteger</span><span class=p>);</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=7.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=70-pretazenie-metod-hashcode-a-equals>7.0 Pretaženie metód hashCode a equals <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/3e95cb44b5c702eb1c6e17072c04b08fe5354910/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#70-pretazenie-metod-hashcode-a-equals title="Permanent link">&para;</a></h4> <!--end--> <p>Nie vždy metódy <code>hashCode</code> a <code>equals</code> spĺňajú požiadavky, ktoré sú špecifické pre použitie v ORM prostredí a musíme ich preťažiť. Ak preťažíme <code>equals</code>, treba preťažiť aj <code>hashCode</code>, lebo ak sa dva prvky rovnajú v <code>equals</code>, majú mať rovnaký <code>hashCode</code>. </p> <p><a href=https://thorben-janssen.com/ultimate-guide-to-implementing-equals-and-hashcode-with-hibernate/ >Vysvetlenie prečo a akým spôsobom implementujeme hashCode a equals v prostredí ORM.</a></p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Pre vygenerovanie <code>hashCode</code> a <code>equals</code> možeme využiť v prostredí InteliJ funkciu generovania dostupnú cez skratku <code>Alt + insert</code>. <img alt src=../images/Screenshot_20200520_101452.png#center></p> </div> <!--tgen step=7.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/3e95cb44b5c702eb1c6e17072c04b08fe5354910/src/main/java/sk/fri/uniza/model/AbstractData.java>🖹</a> src/main/java/sk/fri/uniza/model/AbstractData.java</strong></p> <p>public abstract class AbstractData<t extends object> {</p> </blockquote> <div class=tabbed-set data-tabs=50:2> <input name=__tabbed_50 type=radio id=__tabbed_50_1 checked=checked><label for=__tabbed_50_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>equals</span><span class=p>(</span><span class=n>Object</span> <span class=n>o</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=k>this</span> <span class=o>==</span> <span class=n>o</span><span class=p>)</span> <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span><span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=n>o</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>getClass</span><span class=p>()</span> <span class=o>!=</span> <span class=n>o</span><span class=p>.</span><span class=na>getClass</span><span class=p>())</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>AbstractData</span><span class=o>&lt;?&gt;</span> <span class=n>that</span> <span class=o>=</span> <span class=p>(</span><span class=n>AbstractData</span><span class=o>&lt;?&gt;</span><span class=p>)</span> <span class=n>o</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>        <span class=k>return</span> <span class=n>id</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>?</span> <span class=n>id</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>that</span><span class=p>.</span><span class=na>id</span><span class=p>)</span> <span class=p>:</span> <span class=n>that</span><span class=p>.</span><span class=na>id</span> <span class=o>==</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@Override</span>
</code></pre></div></div> <input name=__tabbed_50 type=radio id=__tabbed_50_2><label for=__tabbed_50_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>equals</span><span class=p>(</span><span class=n>Object</span> <span class=n>o</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@Override</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/3e95cb44b5c702eb1c6e17072c04b08fe5354910/src/main/java/sk/fri/uniza/model/Field.java>🖹</a> src/main/java/sk/fri/uniza/model/Field.java</strong></p> <p>public class Field {</p> </blockquote> <div class=tabbed-set data-tabs=51:2> <input name=__tabbed_51 type=radio id=__tabbed_51_1 checked=checked><label for=__tabbed_51_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>equals</span><span class=p>(</span><span class=n>Object</span> <span class=n>o</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=k>this</span> <span class=o>==</span> <span class=n>o</span><span class=p>)</span> <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span><span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=n>o</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>getClass</span><span class=p>()</span> <span class=o>!=</span> <span class=n>o</span><span class=p>.</span><span class=na>getClass</span><span class=p>())</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>Field</span> <span class=n>field</span> <span class=o>=</span> <span class=p>(</span><span class=n>Field</span><span class=p>)</span> <span class=n>o</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>        <span class=k>return</span> <span class=n>name</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>?</span> <span class=n>name</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>field</span><span class=p>.</span><span class=na>name</span><span class=p>)</span> <span class=p>:</span> <span class=n>field</span><span class=p>.</span><span class=na>name</span> <span class=o>==</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>hashCode</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>name</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>?</span> <span class=n>name</span><span class=p>.</span><span class=na>hashCode</span><span class=p>()</span> <span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getDescripton</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_51 type=radio id=__tabbed_51_2><label for=__tabbed_51_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>equals</span><span class=p>(</span><span class=n>Object</span> <span class=n>o</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>hashCode</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getDescripton</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/3e95cb44b5c702eb1c6e17072c04b08fe5354910/src/main/java/sk/fri/uniza/model/HouseHold.java>🖹</a> src/main/java/sk/fri/uniza/model/HouseHold.java</strong></p> <p>public class HouseHold {</p> </blockquote> <div class=tabbed-set data-tabs=52:2> <input name=__tabbed_52 type=radio id=__tabbed_52_1 checked=checked><label for=__tabbed_52_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>equals</span><span class=p>(</span><span class=n>Object</span> <span class=n>o</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=k>this</span> <span class=o>==</span> <span class=n>o</span><span class=p>)</span> <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span><span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=n>o</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>getClass</span><span class=p>()</span> <span class=o>!=</span> <span class=n>o</span><span class=p>.</span><span class=na>getClass</span><span class=p>())</span> <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span><span class=hll>        <span class=n>HouseHold</span> <span class=n>houseHold</span> <span class=o>=</span> <span class=p>(</span><span class=n>HouseHold</span><span class=p>)</span> <span class=n>o</span><span class=p>;</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>id</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>?</span> <span class=n>id</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>houseHold</span><span class=p>.</span><span class=na>id</span><span class=p>)</span> <span class=p>:</span> <span class=n>houseHold</span><span class=p>.</span><span class=na>id</span> <span class=o>==</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@Override</span>
</code></pre></div></div> <input name=__tabbed_52 type=radio id=__tabbed_52_2><label for=__tabbed_52_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>equals</span><span class=p>(</span><span class=n>Object</span> <span class=n>o</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@Override</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=8.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=80-pridanie-moznosti-vymazat-polozku-field>8.0 Pridanie možnosti vymazať položku Field <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/48468a674ce60f0769a4475db7cae82ebc0b28ed/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#80-pridanie-moznosti-vymazat-polozku-field title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=8.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/48468a674ce60f0769a4475db7cae82ebc0b28ed/src/main/java/sk/fri/uniza/db/FieldDAO.java>🖹</a> src/main/java/sk/fri/uniza/db/FieldDAO.java</strong></p> <p>public class FieldDAO extends AbstractDAO<field> {</p> </blockquote> <div class=tabbed-set data-tabs=53:2> <input name=__tabbed_53 type=radio id=__tabbed_53_1 checked=checked><label for=__tabbed_53_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>delete</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>Field</span> <span class=n>field</span> <span class=o>=</span> <span class=n>get</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
<span class=hll>        <span class=n>currentSession</span><span class=p>().</span><span class=na>remove</span><span class=p>(</span><span class=n>field</span><span class=p>);</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>field</span><span class=p>;</span>
</span><span class=hll>    <span class=p>}</span>
</span>
    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Field</span><span class=o>&gt;</span> <span class=nf>allFields</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_53 type=radio id=__tabbed_53_2><label for=__tabbed_53_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>delete</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
<span class=hll>    <span class=p>}</span>
</span>
    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Field</span><span class=o>&gt;</span> <span class=nf>allFields</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=8.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=81-otestovanie-zmazania-field>8.1 Otestovanie zmazania Field <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/45d4c5c310a3b904973514bf76c61bec487fd963/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#81-otestovanie-zmazania-field title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=8.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/45d4c5c310a3b904973514bf76c61bec487fd963/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=54:2> <input name=__tabbed_54 type=radio id=__tabbed_54_1 checked=checked><label for=__tabbed_54_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>sk.fri.uniza.db.HouseHoldDAO</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.db.IotNodeDAO</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.health.DatabaseHealthCheck</span><span class=p>;</span>
<span class=hll><span class=kn>import</span> <span class=nn>sk.fri.uniza.health.DeleteHealthCheck</span><span class=p>;</span>
</span><span class=kn>import</span> <span class=nn>sk.fri.uniza.model.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.resources.FieldResource</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.resources.HouseHoldResource</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_54 type=radio id=__tabbed_54_2><label for=__tabbed_54_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>sk.fri.uniza.db.HouseHoldDAO</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.db.IotNodeDAO</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.health.DatabaseHealthCheck</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.model.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.resources.FieldResource</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>sk.fri.uniza.resources.HouseHoldResource</span><span class=p>;</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=55:2> <input name=__tabbed_55 type=radio id=__tabbed_55_1 checked=checked><label for=__tabbed_55_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorenie Healthcheck (overenie zdravia aplikácie), ktorý</span>
        <span class=c1>// využijeme na otestovanie databázy</span>
<span class=hll>        <span class=n>UnitOfWorkAwareProxyFactory</span> <span class=n>unitOfWorkAwareProxyFactory</span> <span class=o>=</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>UnitOfWorkAwareProxyFactory</span><span class=p>(</span><span class=n>hibernate</span><span class=p>);</span>
</span>        <span class=kd>final</span> <span class=n>DatabaseHealthCheck</span> <span class=n>databaseHealthCheck</span> <span class=o>=</span>
<span class=hll>                <span class=n>unitOfWorkAwareProxyFactory</span>
</span>                        <span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>DatabaseHealthCheck</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                <span class=k>new</span> <span class=n>Class</span><span class=o>[]</span><span class=p>{</span><span class=n>HouseHoldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                        <span class=n>IotNodeDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</code></pre></div></div> <input name=__tabbed_55 type=radio id=__tabbed_55_2><label for=__tabbed_55_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorenie Healthcheck (overenie zdravia aplikácie), ktorý</span>
        <span class=c1>// využijeme na otestovanie databázy</span>
        <span class=kd>final</span> <span class=n>DatabaseHealthCheck</span> <span class=n>databaseHealthCheck</span> <span class=o>=</span>
<span class=hll>                <span class=k>new</span> <span class=n>UnitOfWorkAwareProxyFactory</span><span class=p>(</span><span class=n>hibernate</span><span class=p>)</span>
</span>                        <span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>DatabaseHealthCheck</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                <span class=k>new</span> <span class=n>Class</span><span class=o>[]</span><span class=p>{</span><span class=n>HouseHoldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
                                        <span class=n>IotNodeDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</code></pre></div></div> </div> <blockquote> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=56:2> <input name=__tabbed_56 type=radio id=__tabbed_56_1 checked=checked><label for=__tabbed_56_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                                <span class=k>new</span> <span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>,</span>
                                        <span class=n>fieldDAO</span><span class=p>,</span> <span class=n>dataDAO</span>
                                <span class=p>});</span>
<span class=hll>        <span class=kd>final</span> <span class=n>DeleteHealthCheck</span> <span class=n>deleteHealthCheck</span> <span class=o>=</span>
</span><span class=hll>                <span class=n>unitOfWorkAwareProxyFactory</span>
</span><span class=hll>                        <span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>DeleteHealthCheck</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                                <span class=n>FieldDAO</span><span class=p>.</span><span class=na>class</span><span class=p>,</span>
</span><span class=hll>                                <span class=n>fieldDAO</span><span class=p>);</span>
</span>        <span class=c1>// Zaregistrovanie Healthcheck</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=s>&quot;databaseHealthcheck&quot;</span><span class=p>,</span> <span class=n>databaseHealthCheck</span><span class=p>);</span>
<span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
</span><span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=s>&quot;deleteHealthcheck&quot;</span><span class=p>,</span> <span class=n>deleteHealthCheck</span><span class=p>);</span>
</span>        <span class=c1>// Spustenie všetkých health kontrol</span>
<span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>().</span><span class=na>runHealthCheck</span><span class=p>(</span><span class=s>&quot;databaseHealthcheck&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>().</span><span class=na>runHealthCheck</span><span class=p>(</span><span class=s>&quot;deleteHealthcheck&quot;</span><span class=p>);</span>
</span>
    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_56 type=radio id=__tabbed_56_2><label for=__tabbed_56_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>                                <span class=k>new</span> <span class=n>Object</span><span class=o>[]</span><span class=p>{</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>,</span>
                                        <span class=n>fieldDAO</span><span class=p>,</span> <span class=n>dataDAO</span>
                                <span class=p>});</span>
        <span class=c1>// Zaregistrovanie Healthcheck</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>()</span>
                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=s>&quot;databaseHealthcheck&quot;</span><span class=p>,</span> <span class=n>databaseHealthCheck</span><span class=p>);</span>
        <span class=c1>// Spustenie všetkých health kontrol</span>
<span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>healthChecks</span><span class=p>().</span><span class=na>runHealthChecks</span><span class=p>();</span>
</span>
    <span class=p>}</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/45d4c5c310a3b904973514bf76c61bec487fd963/src/main/java/sk/fri/uniza/health/DeleteHealthCheck.java>🖹</a> src/main/java/sk/fri/uniza/health/DeleteHealthCheck.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=57:1> <input name=__tabbed_57 type=radio id=__tabbed_57_1 checked=checked><label for=__tabbed_57_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=hll><span class=kn>package</span> <span class=nn>sk.fri.uniza.health</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll><span class=kn>import</span> <span class=nn>com.codahale.metrics.health.HealthCheck</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>io.dropwizard.hibernate.UnitOfWork</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>sk.fri.uniza.db.DataDAO</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>sk.fri.uniza.db.FieldDAO</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll><span class=kd>public</span> <span class=kd>class</span> <span class=nc>DeleteHealthCheck</span> <span class=kd>extends</span> <span class=n>HealthCheck</span> <span class=p>{</span>
</span><span class=hll>    <span class=n>FieldDAO</span> <span class=n>fieldDAO</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=kd>public</span> <span class=nf>DeleteHealthCheck</span><span class=p>(</span><span class=n>FieldDAO</span> <span class=n>fieldDAO</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>this</span><span class=p>.</span><span class=na>fieldDAO</span> <span class=o>=</span> <span class=n>fieldDAO</span><span class=p>;</span>
</span><span class=hll>    <span class=p>}</span>
</span><span class=hll>
</span><span class=hll>    <span class=nd>@Override</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span>
</span><span class=hll>    <span class=kd>protected</span> <span class=n>Result</span> <span class=nf>check</span><span class=p>()</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
</span><span class=hll>        <span class=n>fieldDAO</span><span class=p>.</span><span class=na>delete</span><span class=p>(</span><span class=s>&quot;weather&quot;</span><span class=p>);</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>Result</span><span class=p>.</span><span class=na>healthy</span><span class=p>();</span>
</span><span class=hll>    <span class=p>}</span>
</span><span class=hll><span class=p>}</span>
</span></code></pre></div></div> </div> <!--end--> <!--tgen step=8.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=82-vytvorenie-kaskadovej-akcie-pre-mazanie-prvku-field>8.2 Vytvorenie káskádovej akcie pre mazanie prvku Field <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/b722d81afc0699247f88c3e42390102cebbde2c4/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#82-vytvorenie-kaskadovej-akcie-pre-mazanie-prvku-field title="Permanent link">&para;</a></h4> <!--end--> <p>Pri spustení testu dostaneme nasledovný výsledok:</p> <blockquote> <p>Obsah tabuľky <code>Field</code> <img alt src=../images/Screenshot_20200519_013945.png#center></p> </blockquote> <p><br></p> <blockquote> <p>Obsah tabuľky <code>AbstractData</code> <img alt src=../images/Screenshot_20200519_014005.png#center></p> </blockquote> <p>Vidíme, že z tabuľky <code>Field</code> sa prvok odstránil ale v tabuľke <code>AbstractData</code> ešte ostali jeho dáta. V prípade, že chceme aby hibernate odstránil príslušné dáta, musíme mu prikázať aby zmeny, ktoré sa vykonajú v jednej tabuľke sa premiesili do prepojených tabuliek. Toto sa dá docieliť pridaním <code>cascade = CascadeType.REMOVE</code>. <a href=https://www.baeldung.com/jpa-cascade-types>Viac informácii tu.</a></p> <blockquote> <!--tgen step=8.2 template='mkdocs_body_only'  --> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/b722d81afc0699247f88c3e42390102cebbde2c4/src/main/java/sk/fri/uniza/model/Field.java>🖹</a> src/main/java/sk/fri/uniza/model/Field.java</strong></p> <p>public class Field {</p> </blockquote> <div class=tabbed-set data-tabs=58:2> <input name=__tabbed_58 type=radio id=__tabbed_58_1 checked=checked><label for=__tabbed_58_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>descripton</span><span class=p>;</span>

    <span class=nd>@OneToMany</span><span class=p>(</span><span class=n>fetch</span> <span class=o>=</span> <span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>,</span>
<span class=hll>            <span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&quot;field&quot;</span><span class=p>,</span> <span class=n>cascade</span> <span class=o>=</span> <span class=n>CascadeType</span><span class=p>.</span><span class=na>REMOVE</span><span class=p>)</span>
</span>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// objektu JSON.Generoval by sa obrovský JSON a dochádzalo by aj k</span>
    <span class=c1>// zacykleniu</span>
</code></pre></div></div> <input name=__tabbed_58 type=radio id=__tabbed_58_2><label for=__tabbed_58_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>String</span> <span class=n>descripton</span><span class=p>;</span>

    <span class=nd>@OneToMany</span><span class=p>(</span><span class=n>fetch</span> <span class=o>=</span> <span class=n>FetchType</span><span class=p>.</span><span class=na>LAZY</span><span class=p>,</span>
<span class=hll>            <span class=n>mappedBy</span> <span class=o>=</span> <span class=s>&quot;field&quot;</span><span class=p>)</span>
</span>    <span class=nd>@JsonIgnore</span> <span class=c1>// Ignorovanie danej premenej z pohladu Serializacie do</span>
    <span class=c1>// objektu JSON.Generoval by sa obrovský JSON a dochádzalo by aj k</span>
    <span class=c1>// zacykleniu</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=9.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=90-doplnenie-chybajucich-namedquery>9.0 Doplnenie chýbajúcich NamedQuery <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/6dc5a29749261008b5ba1a49f615735fb89418ec/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#90-doplnenie-chybajucich-namedquery title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=9.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/6dc5a29749261008b5ba1a49f615735fb89418ec/src/main/java/sk/fri/uniza/model/AbstractData.java>🖹</a> src/main/java/sk/fri/uniza/model/AbstractData.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=59:2> <input name=__tabbed_59 type=radio id=__tabbed_59_1 checked=checked><label for=__tabbed_59_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.time.LocalDateTime</span><span class=p>;</span>
<span class=hll><span class=nd>@org.hibernate.annotations.NamedQueries</span><span class=p>({</span>
</span><span class=hll>        <span class=nd>@org.hibernate.annotations.NamedQuery</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;AbstractData_findData&quot;</span><span class=p>,</span>
</span><span class=hll>                <span class=n>query</span> <span class=o>=</span> <span class=s>&quot;from AbstractData where household_id = :hhId AND &quot;</span> <span class=o>+</span>
</span><span class=hll>                        <span class=s>&quot;field_id = :fieldId&quot;</span><span class=p>),</span>
</span><span class=hll>        <span class=nd>@org.hibernate.annotations.NamedQuery</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span>
</span><span class=hll>                <span class=s>&quot;AbstractData_findDataFromTo&quot;</span><span class=p>,</span>
</span><span class=hll>                <span class=n>query</span> <span class=o>=</span> <span class=s>&quot;from AbstractData where household_id = :hhId AND &quot;</span> <span class=o>+</span>
</span><span class=hll>                        <span class=s>&quot;field_id = :fieldId AND dateTime BETWEEN :from&quot;</span> <span class=o>+</span>
</span><span class=hll>                        <span class=s>&quot; AND :to ORDER BY dateTime ASC&quot;</span><span class=p>),</span>
</span><span class=hll><span class=p>})</span>
</span><span class=hll>
</span><span class=nd>@Entity</span>
<span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span>
</code></pre></div></div> <input name=__tabbed_59 type=radio id=__tabbed_59_2><label for=__tabbed_59_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.time.LocalDateTime</span><span class=p>;</span>
<span class=nd>@Entity</span>
<span class=nd>@Inheritance</span><span class=p>(</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>InheritanceType</span><span class=p>.</span><span class=na>SINGLE_TABLE</span><span class=p>)</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/6dc5a29749261008b5ba1a49f615735fb89418ec/src/main/java/sk/fri/uniza/model/Field.java>🖹</a> src/main/java/sk/fri/uniza/model/Field.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=60:2> <input name=__tabbed_60 type=radio id=__tabbed_60_1 checked=checked><label for=__tabbed_60_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.validation.constraints.Size</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>
<span class=hll><span class=nd>@org.hibernate.annotations.NamedQueries</span><span class=p>({</span>
</span><span class=hll>        <span class=nd>@org.hibernate.annotations.NamedQuery</span><span class=p>(</span><span class=n>name</span> <span class=o>=</span> <span class=s>&quot;Field_All&quot;</span><span class=p>,</span>
</span><span class=hll>                <span class=n>query</span> <span class=o>=</span> <span class=s>&quot;from Field&quot;</span><span class=p>),</span>
</span><span class=hll><span class=p>})</span>
</span>
<span class=nd>@Entity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Field</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_60 type=radio id=__tabbed_60_2><label for=__tabbed_60_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.persistence.*</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>javax.validation.constraints.Size</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.Set</span><span class=p>;</span>

<span class=nd>@Entity</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>Field</span> <span class=p>{</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=9.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=91-doplnenie-chybajucich-dao-metod>9.1 Doplnenie chýbajúcich DAO metód <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/c71f8a0dea54816d14a17e178b8afe5b451acf0e/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#91-doplnenie-chybajucich-dao-metod title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=9.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/c71f8a0dea54816d14a17e178b8afe5b451acf0e/src/main/java/sk/fri/uniza/db/DataDAO.java>🖹</a> src/main/java/sk/fri/uniza/db/DataDAO.java</strong></p> <p>public class DataDAO extends AbstractDAO<abstractdata> {</p> </blockquote> <div class=tabbed-set data-tabs=61:2> <input name=__tabbed_61 type=radio id=__tabbed_61_1 checked=checked><label for=__tabbed_61_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>create</span><span class=p>(</span><span class=n>Long</span> <span class=n>houseHoldId</span><span class=p>,</span> <span class=n>String</span> <span class=n>fieldId</span><span class=p>,</span>
                               <span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=kd>throws</span>
            <span class=n>WebApplicationException</span> <span class=p>{</span>
<span class=hll>        <span class=n>HouseHold</span> <span class=n>houseHold</span> <span class=o>=</span>
</span><span class=hll>                <span class=n>currentSession</span><span class=p>().</span><span class=na>get</span><span class=p>(</span><span class=n>HouseHold</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>houseHoldId</span><span class=p>);</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>Field</span> <span class=n>field</span> <span class=o>=</span> <span class=n>currentSession</span><span class=p>().</span><span class=na>get</span><span class=p>(</span><span class=n>Field</span><span class=p>.</span><span class=na>class</span><span class=p>,</span> <span class=n>fieldId</span><span class=p>);</span>
</span><span class=hll>        <span class=k>if</span> <span class=p>(</span><span class=n>houseHold</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>field</span> <span class=o>==</span> <span class=kc>null</span><span class=p>)</span>
</span><span class=hll>            <span class=k>throw</span> <span class=k>new</span> <span class=n>WebApplicationException</span><span class=p>(</span><span class=s>&quot;Column &#39;fieldId&#39; or &quot;</span> <span class=o>+</span>
</span><span class=hll>                    <span class=s>&quot;&#39;houseHoldId&#39; don&#39;t exists  &quot;</span><span class=p>,</span> <span class=mi>400</span><span class=p>);</span>
</span><span class=hll>        <span class=n>data</span><span class=p>.</span><span class=na>setHouseHold</span><span class=p>(</span><span class=n>houseHold</span><span class=p>);</span>
</span><span class=hll>        <span class=n>data</span><span class=p>.</span><span class=na>setField</span><span class=p>(</span><span class=n>field</span><span class=p>);</span>
</span><span class=hll>        <span class=n>currentSession</span><span class=p>().</span><span class=na>save</span><span class=p>(</span><span class=n>data</span><span class=p>);</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>data</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>create</span><span class=p>(</span><span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_61 type=radio id=__tabbed_61_2><label for=__tabbed_61_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>create</span><span class=p>(</span><span class=n>Long</span> <span class=n>houseHoldId</span><span class=p>,</span> <span class=n>String</span> <span class=n>fieldId</span><span class=p>,</span>
                               <span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=kd>throws</span>
            <span class=n>WebApplicationException</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>create</span><span class=p>(</span><span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> </div> <blockquote> <p>public class DataDAO extends AbstractDAO<abstractdata> {</p> </blockquote> <div class=tabbed-set data-tabs=62:2> <input name=__tabbed_62 type=radio id=__tabbed_62_1 checked=checked><label for=__tabbed_62_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=nf>findData</span><span class=p>(</span><span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span> <span class=n>String</span> <span class=n>fieldId</span><span class=p>,</span>
                                       <span class=n>LocalDateTime</span> <span class=n>from</span><span class=p>,</span>
                                       <span class=n>LocalDateTime</span> <span class=n>to</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>list</span><span class=p>(</span><span class=n>namedQuery</span><span class=p>(</span><span class=s>&quot;AbstractData_findDataFromTo&quot;</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&quot;hhId&quot;</span><span class=p>,</span> <span class=n>hhId</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&quot;fieldId&quot;</span><span class=p>,</span> <span class=n>fieldId</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&quot;from&quot;</span><span class=p>,</span> <span class=n>from</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>setParameter</span><span class=p>(</span><span class=s>&quot;to&quot;</span><span class=p>,</span> <span class=n>to</span><span class=p>)</span>
</span><span class=hll>        <span class=p>);</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_62 type=radio id=__tabbed_62_2><label for=__tabbed_62_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=nf>findData</span><span class=p>(</span><span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span> <span class=n>String</span> <span class=n>fieldId</span><span class=p>,</span>
                                       <span class=n>LocalDateTime</span> <span class=n>from</span><span class=p>,</span>
                                       <span class=n>LocalDateTime</span> <span class=n>to</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/c71f8a0dea54816d14a17e178b8afe5b451acf0e/src/main/java/sk/fri/uniza/db/FieldDAO.java>🖹</a> src/main/java/sk/fri/uniza/db/FieldDAO.java</strong></p> <p>public class FieldDAO extends AbstractDAO<field> {</p> </blockquote> <div class=tabbed-set data-tabs=63:2> <input name=__tabbed_63 type=radio id=__tabbed_63_1 checked=checked><label for=__tabbed_63_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Field</span><span class=o>&gt;</span> <span class=nf>allFields</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>list</span><span class=p>(</span><span class=n>namedQuery</span><span class=p>(</span><span class=s>&quot;Field_All&quot;</span><span class=p>));</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_63 type=radio id=__tabbed_63_2><label for=__tabbed_63_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Field</span><span class=o>&gt;</span> <span class=nf>allFields</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=9.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=92-zaregistrovanie-zvysnych-rest-zdrojov>9.2 Zaregistrovanie zvyšných REST zdrojov <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/89372962fd42cab13f9dfa933774d6a30a131de1/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#92-zaregistrovanie-zvysnych-rest-zdrojov title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=9.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/89372962fd42cab13f9dfa933774d6a30a131de1/src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java>🖹</a> src/main/java/sk/fri/uniza/HouseHoldServiceApplication.java</strong></p> <p>public class HouseHoldServiceApplication</p> </blockquote> <div class=tabbed-set data-tabs=64:2> <input name=__tabbed_64 type=radio id=__tabbed_64_1 checked=checked><label for=__tabbed_64_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
<span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>HouseHoldResource</span><span class=p>(</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=n>dataDAO</span><span class=p>));</span>
</span><span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
</span><span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>FieldResource</span><span class=p>(</span><span class=n>fieldDAO</span><span class=p>));</span>
</span><span class=hll>        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
</span><span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>DateParameterConverterProvider</span><span class=p>());</span>
</span><span class=hll>
</span>
        <span class=c1>// Vytvorenie Healthcheck (overenie zdravia aplikácie), ktorý</span>
        <span class=c1>// využijeme na otestovanie databázy</span>
</code></pre></div></div> <input name=__tabbed_64 type=radio id=__tabbed_64_2><label for=__tabbed_64_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=c1>// Vytvorené objekty reprezentujúce REST rozhranie</span>
        <span class=n>environment</span><span class=p>.</span><span class=na>jersey</span><span class=p>()</span>
<span class=hll>                <span class=p>.</span><span class=na>register</span><span class=p>(</span><span class=k>new</span> <span class=n>HouseHoldResource</span><span class=p>(</span><span class=n>houseHoldDAO</span><span class=p>,</span> <span class=kc>null</span><span class=p>));</span>
</span>
        <span class=c1>// Vytvorenie Healthcheck (overenie zdravia aplikácie), ktorý</span>
        <span class=c1>// využijeme na otestovanie databázy</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=9.3 template='mkdocs_header_only'  --> <p><br></p> <h4 id=93-implemntovanie-fieldresource-zdroja>9.3 Implemntovanie FieldResource zdroja <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/5d8adf8dbce42ed521e9d16d8a0ec413937b8cc6/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#93-implemntovanie-fieldresource-zdroja title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=9.3 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/5d8adf8dbce42ed521e9d16d8a0ec413937b8cc6/src/main/java/sk/fri/uniza/resources/FieldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/FieldResource.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=65:2> <input name=__tabbed_65 type=radio id=__tabbed_65_1 checked=checked><label for=__tabbed_65_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.ws.rs.core.MediaType</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.List</span><span class=p>;</span>

<span class=hll><span class=nd>@Api</span><span class=p>(</span><span class=s>&quot;/field&quot;</span><span class=p>)</span>
</span><span class=hll><span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;/field&quot;</span><span class=p>)</span>
</span><span class=hll><span class=nd>@Produces</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span>
</span><span class=hll><span class=nd>@Consumes</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span>
</span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>FieldResource</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=n>FieldDAO</span> <span class=n>fieldDAO</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_65 type=radio id=__tabbed_65_2><label for=__tabbed_65_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>javax.ws.rs.core.MediaType</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>java.util.List</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>FieldResource</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=n>FieldDAO</span> <span class=n>fieldDAO</span><span class=p>;</span>
</code></pre></div></div> </div> <blockquote> <p>public class FieldResource {</p> </blockquote> <div class=tabbed-set data-tabs=66:2> <input name=__tabbed_66 type=radio id=__tabbed_66_1 checked=checked><label for=__tabbed_66_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>this</span><span class=p>.</span><span class=na>fieldDAO</span> <span class=o>=</span> <span class=n>fieldDAO</span><span class=p>;</span>
    <span class=p>}</span>

<span class=hll>    <span class=nd>@POST</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Prídá nový typ Field&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>createField</span><span class=p>(</span><span class=nd>@Valid</span> <span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>field</span><span class=p>);</span>
</span>    <span class=p>}</span>

<span class=hll>    <span class=nd>@PUT</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Upraví existujúci Field&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>updateField</span><span class=p>(</span><span class=nd>@Valid</span> <span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>update</span><span class=p>(</span><span class=n>field</span><span class=p>);</span>
</span>    <span class=p>}</span>

<span class=hll>    <span class=nd>@GET</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span><span class=hll>    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{id}&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Zobrazí typ Field&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>findField</span><span class=p>(</span><span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
</span>    <span class=p>}</span>

<span class=hll>    <span class=nd>@DELETE</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span><span class=hll>    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{id}&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Vymaze Field&quot;</span><span class=p>)</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>deleteField</span><span class=p>(</span><span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;id&quot;</span><span class=p>)</span> <span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>delete</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
</span>    <span class=p>}</span>

<span class=hll>    <span class=nd>@GET</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Zobrazí všetky typy Field&quot;</span><span class=p>)</span>
</span>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Field</span><span class=o>&gt;</span> <span class=nf>allFields</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>fieldDAO</span><span class=p>.</span><span class=na>allFields</span><span class=p>();</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_66 type=radio id=__tabbed_66_2><label for=__tabbed_66_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>this</span><span class=p>.</span><span class=na>fieldDAO</span> <span class=o>=</span> <span class=n>fieldDAO</span><span class=p>;</span>
    <span class=p>}</span>

<span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>createField</span><span class=p>(</span><span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

<span class=hll>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>updateField</span><span class=p>(</span><span class=n>Field</span> <span class=n>field</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

<span class=hll>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>findField</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

<span class=hll>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Field</span> <span class=nf>deleteField</span><span class=p>(</span><span class=n>String</span> <span class=n>id</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

<span class=hll>
</span>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Field</span><span class=o>&gt;</span> <span class=nf>allFields</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=9.4 template='mkdocs_header_only'  --> <p><br></p> <h4 id=94-doplnenie-chybajucich-zdrojov-v-triede-householdresource>9.4 Doplnenie chýbajúcich zdrojov v triede HouseHoldResource <a href=https://github.com/hudikm/HouseHoldService_CPD2020/commit/df07898f5e9a85ec4695b1584ccd962a0ca587d5/ ><img alt=🔗 class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#94-doplnenie-chybajucich-zdrojov-v-triede-householdresource title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=9.4 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/HouseHoldService_CPD2020/blob/df07898f5e9a85ec4695b1584ccd962a0ca587d5/src/main/java/sk/fri/uniza/resources/HouseHoldResource.java>🖹</a> src/main/java/sk/fri/uniza/resources/HouseHoldResource.java</strong></p> <p>public class HouseHoldResource {</p> </blockquote> <div class=tabbed-set data-tabs=67:2> <input name=__tabbed_67 type=radio id=__tabbed_67_1 checked=checked><label for=__tabbed_67_1>Nové</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>


<span class=hll>    <span class=nd>@POST</span> <span class=c1>// JAX-RS</span>
</span><span class=hll>    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{householdID}/{fieldID}&quot;</span><span class=p>)</span> <span class=c1>// JAX-RS</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session //Dropwizzard</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Pridá nové dáta&quot;</span><span class=p>)</span> <span class=c1>// Swagger</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>addData</span><span class=p>(</span><span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;householdID&quot;</span><span class=p>)</span><span class=cm>/* JAX-RS */</span> <span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span>
</span><span class=hll>                                <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;fieldID&quot;</span><span class=p>)</span><span class=cm>/*JAX-RS*/</span> <span class=n>String</span> <span class=n>fieldID</span><span class=p>,</span>
</span>                                <span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=n>dataDAO</span><span class=p>.</span><span class=na>create</span><span class=p>(</span><span class=n>hhId</span><span class=p>,</span> <span class=n>fieldID</span><span class=p>,</span> <span class=n>data</span><span class=p>);</span>
</span>    <span class=p>}</span>

<span class=hll>    <span class=nd>@GET</span> <span class=c1>// JAX-RS</span>
</span><span class=hll>    <span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;{householdID}/{fieldID}&quot;</span><span class=p>)</span> <span class=c1>// JAX-RS</span>
</span><span class=hll>    <span class=nd>@UnitOfWork</span> <span class=c1>//Otvorí novú hibernate session // Dropwizzard</span>
</span><span class=hll>    <span class=nd>@ApiOperation</span><span class=p>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&quot;Získanie dát o konkrétnej domácnosti a konkrétneho&quot;</span> <span class=o>+</span>
</span><span class=hll>            <span class=s>&quot; typu&quot;</span><span class=p>)</span> <span class=c1>// Swagger</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=nf>getData</span><span class=p>(</span>
</span><span class=hll>            <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;householdID&quot;</span><span class=p>)</span><span class=cm>/*JAX-RS*/</span> <span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span>
</span><span class=hll>            <span class=nd>@PathParam</span><span class=p>(</span><span class=s>&quot;fieldID&quot;</span><span class=p>)</span><span class=cm>/*JAX-RS*/</span> <span class=n>String</span> <span class=n>fieldID</span><span class=p>,</span>
</span><span class=hll>            <span class=nd>@QueryParam</span><span class=p>(</span><span class=s>&quot;from&quot;</span><span class=p>)</span> <span class=cm>/*JAX-RS*/</span>
</span><span class=hll>            <span class=nd>@DateTimeFormat</span><span class=p>(</span><span class=s>&quot;dd/MM/yyyy HH:mm&quot;</span><span class=p>)</span>
</span><span class=hll>            <span class=cm>/*VLASTNÉ*/</span>
</span><span class=hll>            <span class=nd>@ApiParam</span><span class=p>(</span><span class=n>format</span> <span class=o>=</span> <span class=s>&quot;dd/MM/yyyy HH:mm&quot;</span><span class=p>)</span>
</span><span class=hll>            <span class=c1>//SWAGGER</span>
</span><span class=hll>            <span class=kd>final</span> <span class=n>LocalDateTime</span> <span class=n>from</span><span class=p>,</span>
</span><span class=hll>            <span class=nd>@QueryParam</span><span class=p>(</span><span class=s>&quot;to&quot;</span><span class=p>)</span>
</span><span class=hll>            <span class=nd>@DateTimeFormat</span><span class=p>(</span><span class=s>&quot;dd/MM/yyyy HH:mm&quot;</span><span class=p>)</span>
</span><span class=hll>            <span class=nd>@ApiParam</span><span class=p>(</span><span class=n>format</span> <span class=o>=</span> <span class=s>&quot;dd/MM/yyyy HH:mm&quot;</span><span class=p>)</span> <span class=kd>final</span> <span class=n>LocalDateTime</span> <span class=n>to</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=n>dataDAO</span><span class=p>.</span><span class=na>findData</span><span class=p>(</span><span class=n>hhId</span><span class=p>,</span> <span class=n>fieldID</span><span class=p>,</span> <span class=n>from</span><span class=p>,</span> <span class=n>to</span><span class=p>);</span>
</span>    <span class=p>}</span>

    <span class=nd>@POST</span> <span class=cm>/*JAX-RS*/</span>
</code></pre></div></div> <input name=__tabbed_67 type=radio id=__tabbed_67_2><label for=__tabbed_67_2>Pred úpravou</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>


<span class=hll>    <span class=kd>public</span> <span class=n>AbstractData</span> <span class=nf>addData</span><span class=p>(</span><span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span>
</span><span class=hll>                                <span class=n>String</span> <span class=n>fieldID</span><span class=p>,</span>
</span>                                <span class=n>AbstractData</span> <span class=n>data</span><span class=p>)</span> <span class=p>{</span>
<span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

<span class=hll>
</span><span class=hll>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractData</span><span class=o>&gt;</span> <span class=nf>getData</span><span class=p>(</span><span class=n>Long</span> <span class=n>hhId</span><span class=p>,</span>
</span><span class=hll>                                      <span class=n>String</span> <span class=n>fieldID</span><span class=p>,</span>
</span><span class=hll>                                      <span class=kd>final</span> <span class=n>LocalDateTime</span> <span class=n>from</span><span class=p>,</span>
</span><span class=hll>                                      <span class=kd>final</span> <span class=n>LocalDateTime</span> <span class=n>to</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span>    <span class=p>}</span>

    <span class=nd>@POST</span> <span class=cm>/*JAX-RS*/</span>
</code></pre></div></div> </div> <!--end--> <!--end--> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../uvod_2/ title=Úvod class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Úvod </div> </div> </a> <a href=../zadanie2/ title=Úloha class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Úloha </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2016 - 2020 Martin Húdik </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/squidfunk target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.83fe6e3c.min.js></script> <script src=../assets/javascripts/bundle.7e1cb91c.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>